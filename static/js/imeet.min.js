function alert_notification(a){$(".alert").remove();var b='<div class="alert alert-{0} alert-dismissible flyover flyover-in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>{1}</div>',c=$("body");a.forEach(function(a){c.prepend(b.format(a.alertType,a.message))})}function init_app(){window.App={Models:{},Collections:{},Views:{},Router:{}},Backbone.pubSub=_.extend({},Backbone.Events),Backbone.pubSub.publish=Backbone.pubSub.trigger,Backbone.pubSub.subscribe=Backbone.pubSub.bind,Backbone.pubSub.unsubscribe=Backbone.pubSub.unbind,index_view=new IndexView({el:"#body-container"}),login_view=new LoginView({el:"#view-container",templateId:"#login"}),user_register_view=new UserRegisterView({el:"#modal_container"}),register_view=new ModalView({el:"#modal_container",childView:user_register_view}),user_profile_view=new UserProfileView({el:"#modal_container"}),profile_view=new ModalView({el:"#modal_container",childView:user_profile_view}),search_view=new SearchView({el:"#modal_container"}),search_view_modal=new ModalView({el:"#modal_container",childView:search_view}),invite_view=new InviteView({el:"#modal_container"}),invite_view_modal=new ModalView({el:$("#modal_container"),childView:invite_view}),sent_view=new SentView({el:"#modal_container"}),sent_view_modal=new ModalView({el:$("#modal_container"),childView:sent_view}),App.Router=Backbone.Router.extend({routes:{"":"index","_=_":"index","new":"new","new/:title":"new","new/:title/from/:id":"new","new/from/:id":"new_no_title","sent/:id":"sent",search:"search",login:"login","profile/edit":"edit_profile",register:"register","view/:id":"view"},index:function(){index_view.render()},login:function(){login_view.render()},register:function(){register_view.render()},edit_profile:function(){profile_view.render()},"new":function(a,b){var c=new CreateView({el:"#view-container"});c.render({title:a,id:b})},new_no_title:function(a){this.new(null,a)},sent:function(a){sent_view_modal.childView.model=a,sent_view_modal.render()},search:function(){search_view_modal.render()},view:function(a){invite_view_modal.render({invite_id:a})}}),window.location.hash&&"#_=_"==window.location.hash&&(window.location.hash=""),new App.Router,Backbone.history.start({pushState:!0}),$("#notification-alerts").toggleClass("in"),$("body").on("click",".navigate",function(){var a=$(this).data("where");null!=a?Backbone.history.navigate(a,!0):Backbone.history.navigate("/",!0)}),$("body").on("input propertychange",".floating-label-form-group",function(a){$(this).toggleClass("floating-label-form-group-with-value",!!$(a.target).val())}).on("focus",".floating-label-form-group",function(){$(this).addClass("floating-label-form-group-with-focus")}).on("blur",".floating-label-form-group",function(){$(this).removeClass("floating-label-form-group-with-focus")})}this.JST=this.JST||{},this.JST["editProfile.html"]=function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div class="modal-content">\r\n        <div class="close-modal" data-action="dismiss">\r\n            <div class="lr">\r\n                <div class="rl">\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="container">\r\n            <h4>Edit your profile</h4>\r\n           <div class="row controls">\r\n               <div class="col-sm-3"></div>\r\n                <div class="col-sm-6">\r\n                    <br/><br/>\r\n                    <div class="floating-label-form-group">\r\n                        <div id="edit-profile-email">Email</div>\r\n                    </div>\r\n                    <br/><br/>\r\n                    <div class="floating-label-form-group">\r\n                        <label for="edit-profile-name" class="fl">Full Name</label>\r\n                        <input id="edit-profile-name" type="text" class="form-control valid-before-submit" placeholder="John Smith..."\r\n                                data-validation="required">\r\n                    </div>\r\n                    <div class="floating-label-form-group">\r\n                        <label for="edit-profile-username" class="fl" data-validation="required">Username</label>\r\n                        <input id="edit-profile-username" type="text" class="form-control valid-before-submit" placeholder="username..." data-validation="required">\r\n                    </div>\r\n                    <div class="floating-label-form-group">\r\n                        <label for="edit-profile-username" class="fl" data-validation="required">Pasword</label>\r\n                        <input id="edit_profile_password" name="edit_profile_password" type="password" class="form-control valid-before-submit" placeholder="password..." data-validation="required">\r\n                    </div>\r\n                    <div class="floating-label-form-group">\r\n                        <label for="edit-profile-username" class="fl">Pasword Confirm</label>\r\n                        <input name="edit_profile_password_confirm" id="edit_profile_password_confirm" type="password" class="form-control valid-before-submit" placeholder=" confirm password..." data-validation="required">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="form-group col-xs-9 medium-margin">\r\n                <a class="btn btn-primary btn-lg save-profile pull-right" role="button">Save</a>\r\n            </div>\r\n        </div>\r\n</div>\r\n';return __p},this.JST["invite.html"]=function(obj){obj||(obj={});var __p="";with(_.escape,Array.prototype.join,obj)__p+='<div class="snap-panel invite-create">\r\n    <section data-panel="first" class="container invite first">\r\n        <div class="row text-center invite-content ">\r\n            <div class="">\r\n                <h4>Event</h4>\r\n            </div>\r\n            <div class="">\r\n\r\n                ',null==currentUser&&(__p+='\r\n                    <label class="small-text">\r\n                    Note: For sms/calls to work, you have to be a registered\r\n                    <br/>\r\n                    Note2: Sms/calls will be free only during the beta phase. After that a subscription base fee will be offered\r\n                    </label>\r\n                '),__p+='\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-xs-12 col-md-8 col-md-offset-2">\r\n                    <input required type="text" class="form-control event-name valid-before-submit" placeholder="Event" autofocus data-validation="required" >\r\n                </div>\r\n            </div>\r\n\r\n            <div class="row">\r\n                <div class="col-xs-12  col-md-3 col-md-offset-2">\r\n                    <div class="date-group" id="start-date-group">\r\n                        <input readonly="true" required type="text" class="date event-start-date valid-before-submit" placeholder="01/01/2000"\r\n                               data-validation="required,date"\r\n                        >\r\n                        <input readonly="true" required type="int" class="time event-start-time  valid-before-submit" placeholder="00:00 AM" data-validation="required" >\r\n                    </div>\r\n                </div>\r\n                <div class="col-xs-12 col-md-2 text-center label-text">\r\n                    To\r\n                </div>\r\n                <div class="col-xs-12 col-md-3">\r\n                    <div class="date-group">\r\n                        <input readonly="true" required type="text" class="date event-end-date" placeholder="01/01/2000">\r\n                        <input readonly="true" required type="text" class="time event-end-time" placeholder="00:00 AM"  >\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-xs-12 col-md-8 col-md-offset-2">\r\n                  <textarea class="form-control event-description desktop tablet" rows="6"></textarea>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="row  menu-container menu-down">\r\n            <ul class="menu">\r\n                <li>\r\n                    <a href="" data-panel="second"><i class="fa fa-angle-down fa-5x"></i></a>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </section>\r\n\r\n        <section data-panel="second" class="container invite second">\r\n\r\n            <div class="row text-center invite-content ">\r\n                <div class="">\r\n                    <h4>Where</h4>\r\n                </div>\r\n\r\n                <div class="row">\r\n                    <div class="col-xs-8 col-md-6 col-md-offset-2">\r\n                        <input type="text" class="form-control event-address-street" placeholder="Address"  >\r\n                    </div>\r\n                    <div class="col-xs-4 col-md-2">\r\n                        <input type="text" class="form-control event-address-suite" placeholder="Apt"  >\r\n                    </div>\r\n                </div>\r\n                <div class="row">\r\n                    <div class="col-xs-12 col-md-4 col-md-offset-2">\r\n                        <input type="text" class="form-control event-address-city" placeholder="City"  >\r\n                    </div>\r\n\r\n                    <div class="col-xs-8 col-md-2">\r\n                        <select class="form-control event-address-state" placeholder="State">\r\n\r\n                        </select>\r\n                    </div>\r\n                    <div class="col-xs-4 col-md-2">\r\n                        <input type="text" class="form-control event-address-zip" placeholder="Zip"  >\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="row menu-container menu-down desktop tablet">\r\n                <ul class="menu">\r\n                    <li>\r\n                        <a href="" data-panel="third"><i class="fa fa-angle-down fa-5x"></i></a>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </section>\r\n\r\n        <section data-panel="third" class="container invite third">\r\n            <div class="row text-center invite-content ">\r\n                <div class="row2 text-center">\r\n                    <h4>Who is invited?</h4>\r\n                </div>\r\n\r\n                <div class="row zero-margin">\r\n                    <div class="col-md-4 col-md-offset-2">\r\n                        <input type="text" class="new-contact-name form-control" placeholder="Name">\r\n                    </div>\r\n\r\n                    <div class="col-md-3">\r\n                        <input type="text" class="new-contact-phone form-control"\r\n                            ',__p+=-1!=features.indexOf("voice")?"\r\n                                data-validation='required,email|phone' placeholder='Phone Number or Email Address'\r\n                            ":"\r\n                                data-validation='required,email' placeholder='Email Address'\r\n                            ",__p+='\r\n                            name="newPhone" id="newPhone">\r\n                    </div>\r\n                    <div class="col-md-1">\r\n                        <button type="button" class="btn btn-info new-contact form-control">+</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="row2 contact-table">\r\n                </div>\r\n            </div>\r\n\r\n            <div class="row menu-container menu-down  desktop tablet">\r\n                <ul class="menu">\r\n                    <li>\r\n                        <a href="" data-panel="fourth"><i class="fa fa-angle-down fa-5x"></i></a>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </section>\r\n\r\n        <section data-panel="fourth" class="container invite fourth">\r\n            <div class="row text-center invite-content">\r\n                <div id="reportXXX"></div>\r\n            </div>\r\n\r\n             <div class="row  menu-container menu-down">\r\n                <button type="button" class="btn form-control btn-success send">Send</button>\r\n            </div>\r\n        </section>\r\n</div>\r\n\r\n<!--<ul class="menu">-->\r\n    <!--<li>-->\r\n        <!--<a href="" data-panel="first" class="active"><i class="fa fa-circle-line fa-1x"></i></a>-->\r\n    <!--</li>-->\r\n    <!--<li>-->\r\n\r\n    <!--</li>-->\r\n    <!--<li>-->\r\n        <!--<a href="" data-panel="third" ><i class="fa fa-circle-line fa-1x"></i></a>-->\r\n    <!--</li>-->\r\n    <!--<li>-->\r\n        <!--<a href="" data-panel="fourth" ><i class="fa fa-circle-line fa-1x"></i></a>-->\r\n    <!--</li>-->\r\n<!--</ul>-->\r\n\r\n<!-- Footer -->\r\n<div class="section-container footer desktop navbar-fixed-bottom">\r\n<div class="footer-below">\r\n    <div class="container">\r\n      <div class="row">\r\n          <div class="col-lg-12">\r\n              Miami, FL<br/>\r\n              Copyright 2014 &copy; iMeet Inc. All rights reserved.\r\n          </div>\r\n      </div>\r\n      <div class="row">\r\n        <div class="col-lg-12 quiet">\r\n            <br/>Built with love, Internet style\r\n        </div>\r\n      </div>\r\n    </div>\r\n</div>\r\n</div>\r\n';return __p},this.JST["inviteReport.html"]=function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div class="modal-content">\n        <div class="close-modal" data-action="dismiss">\n            <div class="lr">\n                <div class="rl">\n                </div>\n            </div>\n        </div>\n        <div class="container">\n            <div class="row controls middle">\n                <h4><div class="invite-title pull-left"></div></h4>\n                <div class="pull-left">&nbsp;on&nbsp;</div>\n                <label class="invite-date pull-left"></label>\n            </div>\n\n            <div class="invite-location row pull-left">At Amelia EartHeart Park, Hialeah, FL</div>\n\n            <div class="row medium-margin line"></div>\n\n\n            <div class="row">\n                <div class="col-md-8">\n                    <b>Attendees</b>\n                    <div class="invite-table"></div>\n                </div>\n\n                <div class="col-md-4">\n                    <b>Hangout</b>\n                    <ul class="invite-comments">\n                        <li class="invite-comment-row">\n                            <span class="pull-left invite-comment-author">Javier DePaula:</span>\n                            We are going to rock!\n                        </li>\n                        <li class="invite-comment-row">\n                            <span class="pull-left invite-comment-author">Elena Rita:</span>\n                            This meeting will be awesome!\n                        </li>\n                        <li class="invite-comment-row">\n                            <span class="pull-left invite-comment-author">John McCain:</span>\n                            I will be late, start without me</li>\n                    </ul>\n                    <input placeholder="enter your comment here" class="invite-newComment">\n                </div>\n            </div>\n            <!--<div class="row medium-margin line"></div>-->\n        </div>\n    </div>\n';return __p},this.JST["invite_report.html"]=function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+="<div class=\"row equidistant invite_report\">\r\n    <div class=\"col-xs-12 col-md-8 col-md-offset-2\">\r\n        <div class=\"panel\">\r\n         <div class=\"panel-heading\" >\r\n                <div class=\"row\">\r\n                     <div class='pull-left col-xs-3 col-md-6'><h4 class='event-name'></h4></div>\r\n                     <div class='col-xs-9 col-md-6 text-right'>\r\n                        <div class='col-xs-12 col-md-12 event-start-date-formatted'></div>\r\n                        <div class='col-xs-12 col-md-12 event-end-date-formatted'></div>\r\n                     </div>\r\n                </div>\r\n             </div>\r\n         </div>\r\n\r\n          <div class=\"panel-body container\">\r\n\r\n            <div class='left col-xs-12 col-md-6'>\r\n                <div class=' event-description'></div>\r\n\r\n                <div class='small-margin-top event-where'>\r\n                    <div class='label_title col-md-1 text-right'>Address:</div>\r\n                    <div class='pull-left col-md-5 text-left small-margin-left'>\r\n                        <div class='event-address-street-with-number'></div>\r\n                        <div class='event-address-state-city'></div>\r\n                        <div class='event-address-zip'></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=' right col-xs-12 col-md-3'>\r\n                <ul class=\"contact-read-table\" style=\"list-style: none\">\r\n\r\n                </ul>\r\n            </div>\r\n\r\n\r\n\r\n          </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n";return __p},this.JST["invite_sent.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<div class="modal-content">\r\n    <form id="registerForm">\r\n        <div class="close-modal" data-action="dismiss">\r\n            <div class="lr">\r\n                <div class="rl">\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="container">\r\n            <div class="row">\r\n                Invite Link <a href="http://imeet.io/view/',print(invite_id),__p+='"><h5 class="text-lowercase">http://imeet.io/view/',print(invite_id),__p+='</h5></a>\r\n            </div>\r\n            <div class="row small-margin-top"></div>\r\n            <div class="row">\r\n               Register\r\n               <div class="controls">\r\n                   <div class="col-sm-3"></div>\r\n                    <div class="col-sm-6">\r\n                        <div class="col-sm-9">\r\n                            <input required type="email" class="form-control register-email" placeholder="Enter email..." data-validation="email">\r\n                        </div>\r\n                        <div class="col-sm-3">\r\n                            <button type="button" class="btn btn-success form-control submit-register">Go</button>\r\n                        </div>\r\n                    </div>\r\n                    <div class="col-sm-3"></div>\r\n                </div>\r\n           </div>\r\n        </div>\r\n    </form>\r\n</div>\r\n';return __p},this.JST["register.html"]=function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div class="modal-content">\r\n    <form id="registerForm">\r\n        <div class="close-modal" data-action="dismiss">\r\n            <div class="lr">\r\n                <div class="rl">\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="container">\r\n            <h4>I want in!</h4>\r\n           <div class="row controls">\r\n               <div class="col-sm-3"></div>\r\n                <div class="col-sm-6">\r\n                    <div class="col-sm-9">\r\n                        <input required type="email" class="form-control register-email" placeholder="Enter email..." data-validation="email">\r\n                    </div>\r\n                    <div class="col-sm-3">\r\n                        <button type="button" class="btn btn-success form-control submit-register">Go</button>\r\n                    </div>\r\n                </div>\r\n                <div class="col-sm-3"></div>\r\n            </div>\r\n        </div>\r\n    </form>\r\n</div>\r\n';return __p},this.JST["search.html"]=function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div class="modal-content">\r\n    <div class="close-modal" data-action="dismiss">\r\n        <div class="lr">\r\n            <div class="rl">\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="container">\r\n        <div class="row controls">\r\n            <div class="col-sm-10">\r\n                <input id="searchBox" type="text" class="form-control event-name" placeholder="Invite Title" data-validation="required">\r\n            </div>\r\n            <div class="col-sm-2">\r\n                <button type="button" class="btn btn-success form-control search">Go</button>\r\n            </div>\r\n        </div>\r\n        <div class="row" style="height: 50px"></div>\r\n        <div class="row search-result">\r\n        </div>\r\n    </div>\r\n</div>\r\n';return __p},String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})});var validator={digitsRegex:new RegExp("^[0-9]*$"),charsRegex:new RegExp(".*"),emailRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validateItems:function(a){var b=!0,c=$(a);return c.each(function(a){var d=$(c[a]);b=validator.validateItem(d)&&b}),b},validateString:function(a,b){var c=!1;switch(b){case"required":c=a.length>0;break;case"digits":c=validator.digitsRegex.test(a);break;case"non_numerics":c=validator.charsRegex.test(a);break;case"email":c=0==a.length||validator.emailRegex.test(a);break;case"phone":c=validator.digitsRegex.test(a)&&(10==a.length||0==a.length);break;case"date":var d=new Date(a);c=d instanceof Date&&!isNaN(d.valueOf());break;case"time":c=!0}return c},validateItem:function(a){var b=!0,c=a.data("validation");return c.split(",").forEach(function(c){var d=-1;if(c.indexOf(":")>=0){var e=c.split(":");c=e[0],d=parseInt(e[1])}var f;try{var g=a.val();if(a.is(":checkbox")&&(a.is(":checked")||(g="")),-1!=c.indexOf("|")){var h=function(a,b){var b=c.split("|"),d=a.split(",");if(0==d.length||0==b.length)return!0;var e=!0;return d.forEach(function(a){a=a.trim();var c=!1;b.forEach(function(b){c=validator.validateString(a,b)||c}),e=e&&c}),e};f=h(g,c)}else f=validator.validateString(g,c);-1!=d&&(f=f&&g.length==d)}catch(i){f=!1}b=f&&b}),a.is(":checkbox")&&(a=a.parent()),b?this.succeedValidationForItem(a):this.errorValidationForItem(a),b},errorValidationForItem:function(a){this.validationUI(a,!0)},succeedValidationForItem:function(a){this.validationUI(a,!1)},validationUI:function(a,b){b?a.addClass("failed-validation"):a.removeClass("failed-validation");var c=a.data("validation-siblings");null!=c&&c.split(",").forEach(function(a){var c=$(a);b?c.addClass("failed-validation"):c.removeClass("failed-validation")})}};SimpleView=Backbone.View.extend({initialize:function(a){this.options=a||{}},hidePanels:function(){$("#body-container").hide(),$("#view-container").show(),$("#modal_container").hide()}});var inviteBindings={".event-name":"title",".event-start-date":"start_date",".event-start-time":"start_time",".event-end-date":"end_date",".event-end-time":"end_time",".event-description":"description",".event-address-street":"address.street",".event-address-suite":"address.suite",".event-address-city":"address.city",".event-address-zip":"address.zip",".event-address-state":{observe:"address.state",selectOptions:{collection:function(){return[{value:null,label:""},{value:"FL",label:"Florida"},{value:"NY",label:"New York"},{value:"CA",label:"California"}]}}},".event-start-date-formatted":{observe:["start_date","start_time"],onGet:function(a){return Date.parse(a[0]+" "+a[1])?"From: "+a[0]+" "+a[1]:void 0}},".event-end-date-formatted":{observe:["end_date","end_time"],onGet:function(a){return"To: "+a[0]+" "+a[1]}},".event-address-state-city":{observe:["address.state","address.city"],onGet:function(a){var b=a[0]||"",c=a[1]||"";return null==b&&null==c?"":c+", "+b}},".event-address-street-with-number":{observe:["address.street","address.suite"],onGet:function(a){var b=a[0]||"",c=a[1]||"";return b+" "+c}}};InviteModel=Backbone.Model.extend({defaults:{title:"",start_date:"",start_time:"",end_date:"",end_time:"",description:"","address.street":"","address.suite":"","address.city":"","address.state":"","address.zip":"",contacts:[]}});var inviteBindings={".event-name":"title",".event-start-date":"start_date",".event-start-time":"start_time",".event-end-date":"end_date",".event-end-time":"end_time",".event-description":"description",".event-address-street":"address.street",".event-address-suite":"address.suite",".event-address-city":"address.city",".event-address-zip":"address.zip",".event-address-state":{observe:"address.state",selectOptions:{collection:function(){return[{value:null,label:""},{value:"FL",label:"Florida"},{value:"NY",label:"New York"},{value:"CA",label:"California"}]}}},".event-start-date-formatted":{observe:["start_date","start_time"],onGet:function(a){return"From: "+a[0]+" "+a[1]}},".event-end-date-formatted":{observe:["end_date","end_time"],onGet:function(a){return"To: "+a[0]+" "+a[1]}},".event-address-state-city":{observe:["address.state","address.city"],onGet:function(a){var b=a[0]||"",c=a[1]||"";return null==b&&null==c?"":c+" "+b}},".event-address-street-with-number":{observe:["address.street","address.suite"],onGet:function(a){var b=a[0]||"",c=a[1]||"";return b+" "+c}}};CreateContactView=Backbone.View.extend({}),ReadContactView=Backbone.View.extend({}),CreateView=SimpleView.extend({el:"#header-container",new_contact_string:"            <div id='contact_{2}'  class='contact-row equidistant' data-contact='{0};{1};{2}'>                <div class='col-md-4 col-md-offset-2'> {0}</div>                <div class='col-md-3'> {1}</div>                <div class='col-md-1'>                     <button type='button' class='btn btn-danger remove-contact form-control' data-row='{2}'>-</button>                              </div>             </div>",reportView:null,initialize:function(a){this.options=a||{}},events:{"click .new-contact":"newContact","click .remove-contact":"removeContact","click .send":"submitNew"},template:JST["invite.html"],render:function(a){return this.hidePanels(),this.bindings=inviteBindings,this.$el.html(this.template()),this.$table=this.$el.find(".contact-table"),this.$btSend=this.$el.find(".send"),this.$new_name=this.$el.find(".new-contact-name"),this.$new_phone=this.$el.find(".new-contact-phone"),this.$btSend=this.$el.find(".send"),this.i=0,null!=a.id?this.createFromInvite(a.id):(this.model=new InviteModel({title:a.title}),this.reportView=new ReportView({model:this.model,el:"#reportXXX"}),this.reportView.render(),this.stickit()),this.plugins(),this},createFromInvite:function(a){var b=this;$.ajax({url:"/api/invite/"+a,type:"GET",cache:!1,success:function(a){b.model=new InviteModel({title:a.title,description:a.description,start_date:moment(a.start).format("L"),start_time:moment(a.start).format("LT"),contacts:[]}),a.end&&(b.model.attributes.end_date=moment(a.end).format("L"),b.model.attributes.end_time=moment(a.end).format("LT")),b.reportView=new ReportView({model:b.model,el:"#reportXXX"}),b.reportView.render(),a.contacts.forEach(function(a){a.index=b.i,a.address=[a.phone,a.email].join(","),b.$table.append(b.new_contact_string.format(a.name,a.address,a.index)),b.model.attributes.contacts.push(a),b.reportView.addContact(a),this.i++}),a.where&&(b.model.attributes["address.street"]=a.where.address,b.model.attributes["address.suite"]=a.where.suite,b.model.attributes["address.city"]=a.where.city,b.model.attributes["address.state"]=a.where.state,b.model.attributes["address.zip"]=a.where.zip),b.stickit()},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},newContact:function(){if(!validator.validateItem(this.$new_phone))return alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}]),void 0;var a={name:this.$new_name.val(),address:this.$new_phone.val(),index:this.i};return this.$new_name.val(""),this.$new_phone.val(""),this.$table.append(this.new_contact_string.format(a.name,a.address,a.index)),this.reportView.addContact(a),this.model.attributes.contacts.push(a),this.i++,!1},removeContact:function(a){var b="#contact_"+$(a.currentTarget).data("row");this.$table.find(b).remove(),this.reportView.removeContact(b),this.$el.find(".contact-row"),this.removeContactByIndex(parseInt(b.split("_")[1]))},removeContactByIndex:function(a){var b=0;this.model.attributes.contacts.forEach(function(c){return c.index==a?b:(b++,void 0)}),this.model.attributes.contacts.splice(b,1)},submitNew:function(){if(!validator.validateItems(".valid-before-submit")||0==this.model.attributes.contacts.length)return alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}]),void 0;var a={title:this.model.attributes.title,description:this.model.attributes.description,start:this.model.attributes.start_date+" "+this.model.attributes.start_time,end:isNaN(this.model.attributes.end_date)?this.model.attributes.end_date+" "+this.model.attributes.end_time:null,where:{address:this.model.attributes["address.street"],suite:this.model.attributes["address.suite"],city:this.model.attributes["address.city"],state:this.model.attributes["address.state"],zip:this.model.attributes["address.zip"]},user_id:null!=currentUser?currentUser.id:null,contacts:this.normalizeContacts(this.model.attributes.contacts)};$.ajax({url:"/api/invite",type:"POST",contentType:"application/json",data:JSON.stringify(a),cache:!1,success:function(a){alert_notification([{alertType:"success",message:"Event sent!"}]),null==currentUser?Backbone.history.navigate("sent/"+a[0],!0):Backbone.history.navigate("view/"+a[0],!0)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},normalizeContacts:function(a){var b=[],c=this;return a.forEach(function(a){var d=c.parsePhoneAndEmail(a.address);b.push({name:a.name,email:d.email,phone:d.phone})}),b},parsePhoneAndEmail:function(a){a.trim();var b=a.split(";");1==b.length&&(b=a.split(","));for(var c=0;c<b.length;c++)b[c]=b[c].trim();return 1==b.length?isNaN(b[0])?{email:b[0],phone:""}:{phone:b[0],email:""}:isNaN(b[0])?{email:b[0],phone:b[1]}:{phone:b[0],email:b[1]}},plugins:function(){this.$el.find(".event-start-date, .event-end-date").datetimepicker({pickTime:!1}),this.$el.find(".event-start-time, .event-end-time").datetimepicker({pickDate:!1});try{$("a .active"),this.$el.find(".snap-panel").panelSnap({menuSelector:"a",onSnapStart:function(){},onSnapFinish:function(){},onActivate:function(){},directionThreshold:50,slideSpeed:200,$menu:this.$el.find(".menu"),keyboardNavigation:{enabled:!0,nextPanelKey:40,previousPanelKey:38,wrapAround:!1}})}catch(a){}}}),IndexView=Backbone.View.extend({initialize:function(a){this.options=a||{}},events:{"click .imeet-btn":"createNew","keypress .invite-title-input":"type_key"},type_key:function(a){return 13==a.keyCode?(this.createNew(),a.preventDefault(),!1):void 0},render:function(){$("#view-container").hide(),this.$el.show(),this.$inviteTitle=this.$el.find(".invite-title-input"),this.$headerImage=this.$el.find(".header-section")},createNew:function(){var a=this.$inviteTitle.val();null!=a&&""!=a?Backbone.history.navigate("/new/"+a,!0):alert("type a title!")}}),InviteView=Backbone.View.extend({template:JST["inviteReport.html"],inviteId:null,initialize:function(a){this.options=a||{},this.inviteId=this.options.id},render:function(a){this.inviteId=a.invite_id,null==this.inviteId&&console.error("Invite Id is null, check routing"),this.$el.html(this.template()),$.ajax({url:"/api/invite/"+this.inviteId,type:"GET",cache:!1,success:function(a){var b=$(".invite-title"),c=$(".invite-date"),d=$(".invite-table");b.html(a.title),c.html(a.start);var e="            <div class='row contact-row small-margin {3}' data-contact='{0},{1},{2}' >                     <div class='col-sm-2'> {0} </div>                     <div class='col-sm-2'>  {1} </div>                     <div class='col-sm-2'> {2}</div>             </div> ";
a.contacts.forEach(function(a){var b="";(null!=a.sms_response||null!=a.voice_reponse||null!=a.email_response)&&(b="alert-success"),d.append(e.format(a.name||"N/A",a.email||"",a.phone||"",b))})}})}}),ReportView=Backbone.View.extend({bindings:inviteBindings,new_contact_string:"            <li id='contact_{2}' class='contact-row' data-contact='{0};{1};{2}'>                {0} - {1}             </li>",initialize:function(a){this.options=a||{},this.model=this.options.model},template:JST["invite_report.html"],render:function(){return this.$el.html(this.template()),this.$report_table=this.$el.find(".contact-read-table"),this.stickit(),this},addContact:function(a){this.$report_table.append(this.new_contact_string.format(a.name,a.address,a.index))},removeContact:function(a){this.$report_table.find(a).remove()}}),LoginView=SimpleView.extend({render:function(){if(this.hidePanels(),null!=this.options.templateId){var a=_.template($(this.options.templateId).html(),{});this.$el.html(a),this.$el.show()}}}),ModalView=Backbone.View.extend({childView:null,template:null,initialize:function(a){this.options=a||{},this.childView=this.options.childView,this.template=this.options.template,(null==Backbone.pubSub._events||null==Backbone.pubSub._events.childClose)&&Backbone.pubSub.on("childClose",this.onChildClose,this)},render:function(a){this.$el;var b=this;if(null!=this.options.templateId){var c=_.template($(this.options.templateId).html(),{});this.$el.html(c)}else null!=this.template&&this.$el.html(this.template());return null!=this.childView&&this.childView.render(a),this.$el.find(".close-modal").click(function(){b.onChildClose({view:b.childView})}),this.$el.show(),this},onChildClose:function(){null!=this.$el&&this.$el.hide(),Backbone.history.navigate("",!0)}}),UserProfileView=Backbone.View.extend({template:JST["editProfile.html"],initialize:function(a){this.options=a||{}},events:{"click .save-profile":"save"},render:function(){this.$el.html(this.template()),this.$name=this.$el.find("#edit-profile-name"),this.$username=this.$el.find("#edit-profile-username"),this.$password=this.$el.find("#edit_profile_password"),this.$email=this.$el.find("#edit-profile-email");var a=this;$.ajax({url:"/api/profile/"+currentUser.id,type:"GET",cache:!1,success:function(b){null!=b.email&&(a.$email.html(b.email),a.$email.parent().addClass("floating-label-form-group-with-value")),null!=b.username&&(a.$username.val(b.username),a.$username.parent().addClass("floating-label-form-group-with-value")),null!=b.name&&(a.$name.val(b.name+" "+b.last_name),a.$name.parent().addClass("floating-label-form-group-with-value"))}})},save:function(){if(validator.validateItems(".valid-before-submit")){var a={username:this.$username.val(),password:this.$password.val()};null!=this.$name.val()&&(a.name=this.$name.val().split(" ")[0],a.last_name=this.$name.val().split(" ")[1]);var b=this;$.ajax({url:"/api/profile/"+currentUser.id,type:"POST",data:JSON.stringify(a),cache:!1,success:function(){Backbone.pubSub.trigger("childClose",{view:b})}})}}}),SearchView=Backbone.View.extend({template:JST["search.html"],invite_string:"            <div class='row'>                 <div class='col-sm-4 col-md-offset-2'>  <a href='#' class='navigate' data-action='modal' data-where='view/{0}'>{1}</a> </div>                 <div class='col-sm-3'>  {2} </div>                 <div class='col-sm-2'> <button type='button' class='navigate btn btn-info form-control' data-where='new/from/{0}'>Copy</button></div>             </div>            <div class='small-margin-top'> </div>     ",initialize:function(a){this.options=a||{}},events:{"click .search":"search","keypress #searchBox":"type_key"},render:function(){this.$el.html(this.template()),this.$searchBox=this.$el.find("#searchBox"),this.search()},type_key:function(a){return 13==a.keyCode?(this.search(),a.preventDefault(),!1):void 0},search:function(){var a=this;$.ajax({url:"/api/invite/search/"+currentUser.id+"?term="+this.$searchBox.val(),type:"GET",cache:!1,success:function(b){if(null!=b){var c=$(".search-result");c.empty(),b.forEach(function(b){c.append(a.invite_string.format(b.unique_id,b.title,b.start,b.end))})}}})}}),SentView=Backbone.View.extend({template:JST["invite_sent.html"],initialize:function(a){this.options=a||{}},events:{"click .submit-register":"registerEmail"},render:function(){this.$el.html(this.template({invite_id:this.model})),this.$email=this.$el.find(".register-email")},registerEmail:function(){if(!validator.validateItem(this.$email))return alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}]),void 0;var a=this;$.ajax({url:"/register/email/"+this.$email.val(),type:"POST",cache:!1,success:function(){alert_notification([{alertType:"success",message:"Account Created Successfully, please check your email"}]),Backbone.pubSub.trigger("childClose",{view:a})},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}),UserRegisterView=Backbone.View.extend({template:JST["register.html"],initialize:function(a){this.options=a||{}},events:{"click .submit-register":"registerEmail"},render:function(){this.$el.html(this.template()),this.$email=this.$el.find(".register-email")},registerEmail:function(){if(!validator.validateItem(this.$email))return alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}]),void 0;var a=this;$.ajax({url:"/register/email/"+this.$email.val(),type:"POST",cache:!1,success:function(){alert_notification([{alertType:"success",message:"Account Created Successfully, please check your email"}]),Backbone.pubSub.trigger("childClose",{view:a})},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}),$(function(){init_app()});