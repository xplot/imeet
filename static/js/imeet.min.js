function isNullOrEmpty(a){return null==a||""===a}function guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}function alert_notification(a,b){$(".alert").remove();var c='<div class="alert alert-{0} alert-dismissible flyover flyover-in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>{1}</div>',d=$("body");a.forEach(function(a){d.prepend(c.format(a.alertType,a.message))}),null!=b&&setTimeout(function(){$(".alert").fadeOut(2e3,function(){$(".alert").remove()})},b)}function contactCreateView(){return null==_contactCreateView&&(_contactCreateView=new ContactDetailsView),_contactCreateView}function groupCreateView(){return null==_groupCreateView&&(_groupCreateView=new GroupDetailsView),_groupCreateView}function init_app(){window.App={Models:{},Collections:{},Views:{},Router:{}},Backbone.pubSub=_.extend({},Backbone.Events),Backbone.pubSub.publish=Backbone.pubSub.trigger,Backbone.pubSub.subscribe=Backbone.pubSub.bind,Backbone.pubSub.unsubscribe=Backbone.pubSub.unbind,index_view=new IndexView({el:"#body-container"}),login_view=new LoginView({el:"#view-container",templateId:"#login"}),user_register_view=new UserRegisterView({el:"#view-container"}),user_profile_view=new ProfileEditView({el:"#view-container"}),search_view=new SearchView({el:"#view-container"}),admin_view=new InviteAdminView({el:"#invite-body"}),invite_view=new InviteView({el:"#invite-body"}),sent_view=new SentView({el:"#modal_container"}),sent_view_modal=new ModalView({el:$("#modal_container"),childView:sent_view}),contacts_view=new ContactsView({el:"#contact-list"}),groups_view=new GroupsView({el:"#contact-list"}),App.Router=Backbone.Router.extend({routes:{"":"index","_=_":"index","new":"new","new/:title":"new","new/:title/from/:id":"new","new/from/:id":"new_no_title","sent/:id":"sent",search:"search",login:"login","profile/edit":"edit_profile",register:"register","invite/:id/edit":"view_as_organizer","invite/:id":"view_as_attendee","invite/:id/:invite_attendee_id":"view_as_attendee",contacts:"contacts",groups:"groups","contacts/new":"contacts_new"},index:function(){index_view.render()},login:function(){login_view.render()},register:function(){user_register_view.render()},edit_profile:function(){user_profile_view.render()},"new":function(a,b){var c=new InviteCreateView({el:"#view-container"});c.render({title:a,id:b})},new_no_title:function(a){this["new"](null,a)},sent:function(a){sent_view_modal.childView.model=a,sent_view_modal.render()},search:function(){search_view.render()},view_as_organizer:function(a){var b="undefined"!=typeof invite?invite:null,c="undefined"!=typeof invite_attendee?invite_attendee:null;admin_view.render(a,b,c)},view_as_attendee:function(a,b){var c="undefined"!=typeof invite?invite:null,d="undefined"!=typeof invite_attendee?invite_attendee:null;invite_view.render(a,c,d)},contacts:function(){contacts_view.render({contactList:contactList,groupList:groupList})},contacts_new:function(){},groups:function(){groups_view.render({contactList:contactList,groupList:groupList})}}),window.location.hash&&"#_=_"==window.location.hash&&(window.location.hash=""),new App.Router,Backbone.history.start({pushState:!0}),$("#notification-alerts").toggleClass("in"),$("body").on("click",".navigate",function(a){var b=$(this).data("where");null!=b?Backbone.history.navigate(b,!0):Backbone.history.navigate("/",!0)}),$("body").on("input propertychange",".floating-label-form-group",function(a){$(this).toggleClass("floating-label-form-group-with-value",!!$(a.target).val())}).on("focu s",".floating-label-form-group",function(){$(this).addClass("floating-label-form-group-with-focus")}).on("blur",".floating-label-form-group",function(){$(this).removeClass("floating-label-form-group-with-focus")})}this.JST=this.JST||{},this.JST["add-group.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div class="modal addGroup-modal" tabindex="-1" >\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>\n            <h4 class="modal-title" id="myModalLabel">Add New Group</h4>\n            </div>\n            <div class="modal-body">\n                <input type="text" class="form-control new-group-input" />\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default close-dialog" data-dismiss="modal">Close</button>\n                <button type="button" class="btn btn-primary new-group-btn">Create</button>\n        </div>\n    </div>\n  </div>\n</div>';return __p},this.JST["contact_details.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="modal addContact-modal" tabindex="-1" >\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>\n            <h4 class="modal-title" id="myModalLabel">\n                ',__p+=createMode?"\n                    Add New Contact\n              ":"\n                    Edit\n              ",__p+='\n\n            </h4>\n            </div>\n            <div class="modal-body">\n                <div class="row">\n                    <div class="col-md-2">Name: </div>\n                    <div class="col-md-10">\n                        <input type="text" value="'+__e(contact.name)+'" class="form-control contact_input" id="nameInput" placeholder="Jane Doe" data-validation="required">\n                    </div>\n                </div>\n                <div class="row">\n                    <div class="col-md-2">Phone: </div>\n                    <div class="col-md-10">\n                        <input type="text" value="'+__e(contact.phone)+'" class="form-control contact_input" id="phoneInput" placeholder="000 000 0000" data-validation="phone">\n                    </div>\n                </div>\n                <div class="row">\n                    <div class="col-md-2">Email: </div>\n                    <div class="col-md-10">\n                        <input type="text" value="'+__e(contact.email)+'" class="form-control contact_input" id="emailInput" placeholder="john.smith@example.com" data-validation="email">\n                    </div>\n                </div>\n\n                <div class="small-margin-top"></div>\n\n                <div class="row">\n                    <div class="col-md-2">Groups: </div>\n                    <div class="col-md-10">\n                ',__p+=createMode?"\n                        <i>Create the contact first, then you can add it to groups</i>\n                ":'\n                        <div class="contact-groups"></div>\n                ',__p+='\n                    </div>\n                </div>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default close-dialog" data-dismiss="modal">Close</button>\n                <button type="button" class="btn btn-primary new-contact-btn">\n                    ',__p+=createMode?"\n                            Create\n                      ":"\n                            Update\n                      ",__p+="\n                </button>\n        </div>\n    </div>\n  </div>\n</div>";return __p},this.JST["contact_item.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+='<div class="contact-row" data-id="'+__e(unique_id)+'" draggable="true">\n    <div class="editable contact-picture" >\n        <i class="fa fa-person fa-2x"></i>\n    </div>\n\n    <div class="contact-row-container">\n        <div class="contact-name" >\n            '+__e(name)+'\n        </div>\n        <div class="contact-email" >\n            '+__e(email)+'\n        </div>\n        <div class="contact-phone" >\n            '+__e(phone)+'\n        </div>\n    </div>\n\n    <a class="update-contact" href="#"><i class="fa-pen fa-1_2x"></i></a>\n\n    <div class="editable contact-actions">\n        <a class="delete-contact" href="#"><i data-id="'+__e(unique_id)+'" class="fa-delete-garbage-streamline fa-1_2x"></i></a>\n    </div>\n</div>';return __p},this.JST["contact_item_typeahead.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+='<div class="item-container" data-id="'+__e(unique_id)+'">\n    <i class="fa fa-person fa-2x"></i>\n    <b>'+__e(name)+"</b> "+__e(email)+" "+__e(phone)+"\n</div>";return __p},this.JST["contacts.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div id="new-contact-container"></div>\n\n<div class="row no-margin contacts-header">\n\n    <h3 class="current-page">Contacts</h3>\n    <h3 ><a href="#" class="navigate-to-groups inactive-page">Groups</a></h3>\n\n    <a class="btn btn-success add-contact pull-right" href="contacts/new">New Contact</a>\n    <!--<a class="btn add-group pull-right" href="#">New Group</a>-->\n</div>\n\n<div class="row small-margin-top no-margin contacts-table-container">\n    <div id="contacts_table" class="small-margin-top"></div>\n</div>';return __p},this.JST["group_details.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="modal addGroup-modal" tabindex="-1" >\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>\n            <h4 class="modal-title" id="myModalLabel">\n                ',__p+=createMode?"\n                    Add New Group\n              ":"\n                    Edit\n              ",__p+='\n\n            </h4>\n            </div>\n            <div class="modal-body">\n                <div class="row">\n                    <div class="col-md-2">Name: </div>\n                    <div class="col-md-10">\n                        <input type="text" value="'+__e(group.name)+'" class="form-control group_input" id="nameInput" placeholder="My Group" data-validation="required">\n                    </div>\n                </div>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default close-dialog" data-dismiss="modal">Close</button>\n                <button type="button" class="btn btn-primary new-group-btn">\n                    ',__p+=createMode?"\n                            Create\n                      ":"\n                            Update\n                      ",__p+="\n                </button>\n        </div>\n    </div>\n  </div>\n</div>";return __p},this.JST["group_item.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+='<div class="group-row" data-id="'+__e(unique_id)+'" draggable="true">\n    <div class="editable group-picture" >\n        <i class="fa fa-organization fa-2x"></i>\n    </div>\n\n    <div class="group-row-container">\n        <div class="group-name" >\n            '+__e(name)+'\n        </div>\n    </div>\n\n    <a class="update-group" href="#"><i class="fa-pen fa-1_2x"></i></a>\n\n    <div class="editable group-actions">\n        <a class="delete-group" href="#"><i data-id="'+__e(unique_id)+'" class="fa-delete-garbage-streamline fa-1_2x"></i></a>\n    </div>\n</div>';return __p},this.JST["group_item_typeahead.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+='<div class="item-container" data-id="'+__e(unique_id)+'">\n    <i class="fa fa-organization fa-2x"></i>\n    <b>'+__e(name)+"</b>\n</div>";return __p},this.JST["group_search.html"]=function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='\n<div class="contact-group-list col-md-12 no-padding">\n    ',_.each(contact.groups,function(a){__p+="\n        "+(null==(__t=partial("group_item.html",a))?"":__t)+"\n    "}),__p+="\n</div>\n\n",__p+=searchMode?'\n    <input type="text" class="group-input" />\n':"\n    <a href='#' class='add-to-group'>+Add to Group</a>\n";return __p},this.JST["groups.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div id="new-group-container"></div>\n\n<div class="row no-margin groups-header">\n    <h3><a href="#" class="navigate-to-contacts inactive-page">Contacts</a></h3>\n    <h3 class="current-page">Groups</h3>\n\n    <a class="btn btn-success add-group pull-right" href="#">New Group</a>\n</div>\n\n<div class="row small-margin-top no-margin contacts-table-container">\n    <div id="groups_table" class="small-margin-top"></div>\n</div>';return __p},this.JST["invite.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div class="invite-view">\n    <div class="row">\n        <div id="invite-header"></div>\n    </div>\n    <div class="row no-margin">\n        <div id="invite-details" class="invite-subheader-banner palette-editable"></div>\n    </div>\n\n    <div class="row invite-body no-margin">\n        <div class="small-margin-top"></div>\n        <div class="col-md-1"/>\n        <div class="col-md-4 attendees">\n            <div id="invite-attendees">\n                <!--using invite_attendees.html subview-->\n            </div>\n        </div>\n        <div class="col-md-1"/>\n        <div class="col-md-5 hangout">\n            <div class="row small-margin-top desktop desktop-description">\n                <div class="col-md-12">\n                    <h4>Message from the host</h4>\n                    <div class="invite-description"/>\n                </div>\n            </div>\n\n            <div id="invite-comments"></div>\n\n        </div>\n        <div class="col-md-1"/>\n    </div>\n</div>\n\n\n\n';return __p},this.JST["invite_admin.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div class="invite-view">\n    <div class="row">\n        <div id="invite-header"></div>\n    </div>\n    <div class="row no-margin">\n        <div id="invite-details" class="invite-subheader-banner palette-editable"></div>\n    </div>\n\n    <div class="row invite-body no-margin">\n        <div class="small-margin-top"></div>\n        <div class="col-md-1"/>\n        <div class="col-md-4 attendees">\n            <div class="notify-all">\n                Want to let people know? <div class=\'notify-all-btn btn btn btn-success\'>Notify All</div>\n            </div>\n\n            <div id="invite-new-attendee"></div>\n\n            <div id="invite-attendees">\n                <!--using invite_attendees.html subview-->\n            </div>\n        </div>\n        <div class="col-md-1"/>\n        <div class="col-md-5 hangout">\n            <div class="row small-margin-top desktop desktop-description">\n                <div class="col-md-12">\n                    <h4>Message from the host</h4>\n                    <div id="invite-description"/>\n                </div>\n            </div>\n\n            <div id="invite-comments"></div>\n\n        </div>\n        <div class="col-md-1"/>\n    </div>\n</div>\n\n\n\n\n';return __p},this.JST["invite_attendee.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="details">\n    ',"organizer"==status&&(__p+="\n        <b><i>Host</i></b>\n    "),__p+="\n    <b>"+__e(name)+"</b> "+__e(email)+" "+__e(phone)+"\n</div>";return __p},this.JST["invite_attendee_admin.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<a href="#" class="edit-attendee" data-rowid="'+__e(invite_attendee_id)+'" >\n    <div class="details">\n        ',"organizer"==status&&(__p+="\n            <b><i>Host</i></b>\n        "),__p+='\n        <i class="fa-pen fa-1x"></i>&nbsp;<b>'+__e(name)+"</b> "+__e(email)+" "+__e(phone)+"\n    </div>\n</a>";return __p},this.JST["invite_attendee_create.html"]=function(obj){obj||(obj={});var __p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="row rsvp no-margin">\n    <div class="panel panel-default no-border no-margin">\n      <div class="panel-heading no-padding palette-editable">Invite People</div>\n      <div class="panel-body  micro-margin-top">\n          <div>\n              <div class="col-md-10 col-xs-12 no-padding">\n                  <input type="text" class="contact-input form-control"\n                    ',__p+=-1!=features.indexOf("voice")?"\n                    data-validation='required,email|phone' placeholder='Name, Phone Number, Email'\n                    ":"\n                    data-validation='required,email' placeholder='Email Address'\n                    ",__p+='>\n              </div>\n              <div class="col-md-2 col-xs-12 no-padding">\n                  <button type="button" class="btn new-contact-button">+</button>\n              </div>\n          </div>\n      </div>\n    </div>\n</div>';return __p},this.JST["invite_attendees.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)null!=attendee&&"organizer"==attendee.status&&(__p+='\n    <div id="new-contact-container" ></div>\n'),__p+="\n\n",null!=attendee&&"organizer"!=attendee.status&&(__p+='\n    <div class="row rsvp small-margin-top">\n          ',"deleted"!=attendee.status?(__p+='\n            <div class="panel panel-default">\n              <div class="panel-heading palette-editable">\n                  ',"no_response"==attendee.status?__p+="\n                        Are you coming?\n                  ":"no"==attendee.status?__p+="\n                        Sad you can't attend :(\n                  ":"yes"==attendee.status&&(__p+="\n                        Glad you're coming :)\n                  "),__p+='\n              </div>\n\n              <div class="panel-body acknowledge-body">\n                <div class="col-md-6 yes-button">\n                    <button type="button" class="btn form-control btn-success invite-attendees-acknowledge-yes response-'+__e(attendee.status)+'">YES</button>\n                </div>\n                <div class="col-md-6 no-button">\n                    <button type="button" class="btn form-control btn-danger invite-attendees-acknowledge-no response-'+__e(attendee.status)+'">NO</button>\n                </div>\n              </div>\n            </div>\n          '):__p+=null!=attendee&&"deleted"==attendee.status?'\n            <div class="panel panel-default">\n                <div class="panel-heading"></div>\n                  <div class="panel-body">\n                    <b>The organizer removed you from this event</b>\n                </div>\n            </div>\n          ':null!=attendee&&"organizer"==attendee.status?"\n            <!-- Potentially also add people here -->\n          ":"\n\n          ",__p+="\n    </div>\n"),__p+='\n\n<div class="row rsvp no-margin">\n    <div class="panel panel-default no-border">\n      <div class="panel-heading yes palette-editable"> Who is coming? ('+__e(confirmed.length)+')</div>\n      <div class="panel-body">\n        ',_.each(confirmed,function(a){__p+="\n            "+(null==(__t=partial("invite_attendee.html",a))?"":__t)+"\n        "}),__p+='\n      </div>\n   </div>\n\n    <div class="panel panel-default no-border">\n      <div class="panel-heading no palette-editable">Who is not coming? ',negated.length>0&&(__p+="("+__e(negated.length)+")"),__p+='</div>\n      <div class="panel-body">\n        ',_.each(negated,function(a){__p+="\n            "+(null==(__t=partial("invite_attendee.html",a))?"":__t)+"\n        "}),__p+='\n      </div>\n   </div>\n\n    <div class="panel panel-default no-border">\n      <div class="panel-heading palette-editable">\n          Who is invited? ('+__e(confirmed.length+negated.length+no_response.length)+')\n\n      </div>\n\n      <div class="panel-body no-response-table">\n        ',_.each(no_response,function(a){__p+="\n          ",__p+=null!=attendee&&"organizer"==attendee.status?"\n                "+(null==(__t=partial("invite_attendee_admin.html",a))?"":__t)+"\n          ":"\n            "+(null==(__t=partial("invite_attendee.html",a))?"":__t)+"\n          ",__p+="\n        "}),__p+="\n      </div>\n   </div>\n\n\n</div>\n\n";return __p},this.JST["invite_comment.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="row ">\n    <span class="comment-date pull-right">'+__e(on)+'</span>\n    <div class="col-md-12 invite-comment-row">\n        <span class="comment-author">\n            ',__p+=null==author?"\n                Anonymous\n            ":"\n                "+__e(author)+"\n            ",__p+="\n            </span> : "+__e(comment)+"\n    </div>\n</div>";return __p},this.JST["invite_comment_box.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div class="row comment-box" >\n    <div class="col-md-12 no-margin">\n        <textarea class="invite-comment-input"  placeholder="Add comment"></textarea>\n    </div>\n</div>\n\n<div class="row comment-box">\n    <div class="col-md-6 no-margin">\n        <button type="button" class="btn form-control btn-success add-comment">Add Comment</button>\n    </div>\n</div>';return __p},this.JST["invite_comments.html"]=function(obj){obj||(obj={});var __t,__p="";_.escape,Array.prototype.join;with(obj)__p+='<div class="row small-margin-top">\n    <div class="col-md-12 no-margin">\n        <h4>Comments</h4>\n    </div>\n</div>\n\n<div class="row no-margin comment-box">\n    ',null!=current_attendee&&(__p+="\n        "+(null==(__t=partial("invite_comment_box.html",null))?"":__t)+"\n    "),__p+='\n</div>\n\n<div class="row invite-comments">\n    <div class="col-md-12 invite-comments-container">\n        ',_.each(comments,function(a){__p+="\n            "+(null==(__t=partial("invite_comment.html",a))?"":__t)+"\n        "}),__p+="\n    </div>\n</div>\n\n";return __p},this.JST["invite_create.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div id="invite-create">\n    <div class="row no-margin event-title-row">\n        <div class="no-padding col-xs-12 col-md-8 col-md-offset-2 text-center">\n            <h1>Create iMeet <i class="fa fa-paper-plane fa-1x"></i></h1>\n        </div>\n    </div>\n\n    ',null==currentUser&&(__p+='\n        <div class="desktop row no-margin">\n            <div class="no-padding col-xs-12 col-md-8 col-md-offset-2 text-center">\n                <label class="small-text">\n                Note: For sms/calls to work, you have to be a registered\n                <br/>\n                Note2: Sms/calls will be free only during the beta phase. After that a subscription base fee will be offered\n                </label>\n            </div>\n        </div>\n    '),__p+='\n\n    <div class="row no-margin event-title-input-row">\n        <div class="no-padding col-xs-12 col-md-8 col-md-offset-2">\n            <input type="text" class="form-control event-name-input valid-before-submit" placeholder="Event Title" autofocus data-validation="required" value="'+__e(title)+'" >\n        </div>\n    </div>\n\n    <div class="row no-margin location-input-row">\n        <div class="no-padding col-xs-12 col-md-8 col-md-offset-2">\n              <input type="text" class="form-control event-location-input" placeholder="Location...."  >\n        </div>\n    </div>\n\n    <div class="mobile tablet row no-margin from-event-date-row">\n        <div class="no-padding col-xs-12 col-md-2 text-center label-text text-center">\n            <h1>From</h1>\n        </div>\n    </div>\n\n    <div class="row no-margin event-date-row">\n        <div class="no-padding date-group col-xs-12 col-md-3 col-md-offset-2" id="start-date-group">\n            <input readonly="true" required type="text" class="date event-start-date valid-before-submit" placeholder="01/01/2000" data-validation="required,date"  value="'+__e(start_date)+'">\n            <input readonly="true" required type="int" class="time event-start-time  valid-before-submit" placeholder="00:00 AM" data-validation="required"  value="'+__e(start_time)+'">\n        </div>\n\n        <div class="no-padding col-xs-12 col-md-2 text-center to-event-date-row">\n            <h1>To</h1>\n        </div>\n\n        <div class="no-padding date-group col-xs-12  col-md-3 end-event-date-input-row" id="end-date-group">\n            <input readonly="true" required type="text" class="date event-end-date" placeholder="01/01/2000" value="'+__e(end_date)+'">\n            <input readonly="true" required type="text" class="time event-end-time" placeholder="00:00 AM"  value="'+__e(end_time)+'">\n        </div>\n\n    </div>\n\n    <div class="row desktop no-margin description-row">\n        <div class="no-padding col-xs-12 col-md-8 col-md-offset-2 ">\n          <textarea class="form-control event-description-input" rows="6"></textarea>\n        </div>\n    </div>\n\n\n    <!--<div class="no-margin">-->\n        <!--<div class="no-padding col-xs-12  col-md-3 col-md-offset-2">-->\n            <!--<div class=" facebook_share pull-right" style="display: inline-block">-->\n                <!--<div>Share on Facebook</div>-->\n                <!--<div><input type="checkbox"-->\n                   <!--data-toggle="toggle"-->\n                   <!--id="bt_toggle"-->\n                   <!--class="share_to_facebook"-->\n                   <!--data-style="android"-->\n                   <!--data-on=" " data-off=" "-->\n                   <!--data-onstyle="info"-->\n                   <!--data-onstyle="success" data-offstyle="danger" />-->\n                <!--</div>-->\n            <!--</div>-->\n        <!--</div>-->\n    <!--</div>-->\n\n    <div class="row no-margin button-row">\n        <div class="no-padding text-center col-xs-12  col-md-8 col-md-offset-2">\n            <button type="button" class="btn form-control btn-success send">Create</button>\n        </div>\n    </div>\n</div>\n';return __p},this.JST["invite_details.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='\n\n<div id="invite-details-container" class="details-row ',is_edit&&(__p+=" clickable edit"),__p+='">\n',is_admin&&(__p+="\n    <div class=\"row\">\n        <div class='col-md-12 col-xs-12 edit_button_container'>\n        ",__p+=is_edit?'\n            <button class="btn btn-success save_invite">Save</button>\n         ':'\n            <button class="btn btn-success edit_invite">Edit iMeet</button>\n         ',__p+="\n    </div>\n"),__p+='\n\n\n</div>\n\n<div class="row no-margin">\n    <div class="col-md-2 no-padding"></div>\n\n    <div class=\'col-md-2 col-xs-12 no-padding\'>\n        <div class="title">Start</div>\n        ',__p+=is_edit?'\n            <div class="date-group" id="start-date-group">\n                <input readonly="true" required type="text" class="date event-start-date valid-before-submit" placeholder="01/01/2000" data-validation="required,date"  value="'+__e(start_date)+'">\n                <input readonly="true" required type="int" class="time event-start-time  valid-before-submit" placeholder="00:00 AM" data-validation="required"  value="'+__e(start_time)+'">\n            </div>\n        ':'\n            <div class="details invite-date">'+__e(start_date)+" "+__e(start_time)+"</div>\n        ",__p+="\n    </div>\n\n    <div class='col-md-2  col-xs-12 no-padding'>\n        <div class=\"title\">End</div>\n        ",__p+=is_edit?'\n            <div class="date-group" id="end-date-group">\n                <input readonly="true" required type="text" class="date event-end-date" placeholder="01/01/2000" data-validation="date"  value="'+__e(end_date)+'">\n                <input readonly="true" required type="int" class="time event-end-time" placeholder="00:00 AM" data-validation="required"  value="'+__e(end_time)+'">\n            </div>\n        ':'\n            <div class="details invite-end-date">'+__e(end_date)+" "+__e(end_time)+"</div>\n        ",__p+="\n    </div>\n\n     <div class='col-md-4 col-xs-12 invite-location-container no-padding'>\n         ",__p+=is_edit?'\n            <div class="title">Location</div>\n            <div><input type="text" class="form-control event-location-input" placeholder="Location...."  ></div>\n         ':'\n            <div class="location-image"><i class="fa fa-map-pin-streamline fa-15x"></i></div>\n            <div id="invite-location" class="title">\n                '+__e(where)+"\n            </div>\n         ",__p+='\n     </div>\n</div>\n\n<div id="palette-container" class="row no-margin small-margin-top"></div>\n\n</div>\n\n';return __p},this.JST["invite_header.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="block block1 invite-background"\n     ',print(null!=poster_image_id?"style='background-image: url(/image/"+poster_image_id+")'":"style='background-image: url(/img/default_image.jpg)'"),__p+='\n>\n    <div class="center-block">\n       <div class="invite-title-container">\n       </div>\n       <div class="upload">\n            <form id="upload_image_form" data-id="'+__e(unique_id)+'" method="POST" enctype="multipart/form-data">\n                <input type="file" name="upload_image_file" id="upload_image_file" >\n            </form>\n            <button id="image_select_btn" class="btn btn-success">Change cover</button>\n       </div>\n\n    </div>\n\n</div>\n';return __p},this.JST["invite_search.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div id="search-view">\n\n    <div class="row no-margin desktop">\n        <div class="col-sm-10 no-padding">\n            <input id="searchBox" type="text" class="form-control event-name" placeholder="Invite Title" data-validation="required">\n        </div>\n\n        <div class="col-sm-2 no-padding">\n            <button type="button" class="btn btn-success form-control search">Search</button>\n        </div>\n    </div>\n\n    <div class="controls" id="search-result">\n        ',0==invites.length&&(__p+='\n            Your search didn\'t resolved any iMeets. <a href="/new" type="button" class="btn btn-success">Start sending!</a>\n        '),__p+="\n\n        ",_.each(invites,function(a){__p+='\n\n            <div class="block block1 invite-background" data-id="'+__e(a.unique_id)+'"\n                    ',print(null!=a.poster_image_id?"style='background-image: url(/image/"+a.poster_image_id+")'":"style='background-image: url(/img/default_image.jpg)'"),__p+='\n                >\n                <div class="center-block" data-id="'+__e(a.unique_id)+'">\n                    <h1 class="main-h1" data-id="'+__e(a.unique_id)+'">'+__e(a.title)+'</h1>\n                    <div class="actions">\n                        <div class="row">\n                            <div class="col-xs-6 col-md-6 no-padding">\n                                <button type=\'button\' class=\'btn btn-info form-control btn-duplicate\' data-id="'+__e(a.unique_id)+"\">Duplicate</button>\n                            </div>\n\n                            <div class=\"col-xs-6 col-md-6 no-padding edit-btn\">\n                                <button type='button' class='btn btn-info form-control btn-edit' data-id=\""+__e(a.unique_id)+'">Edit</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        '}),__p+="\n    </div>\n</div>\n\n";return __p},this.JST["invite_sent.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<div class="modal-content">\n    <form id="registerForm">\n        <div class="close-modal" data-action="dismiss">\n            <div class="lr">\n                <div class="rl">\n                </div>\n            </div>\n        </div>\n\n        <div class="container">\n            <div class="row">\n                Invite Link <a href="http://imeet.io/invite/',
print(invite_id),__p+='"><h5 class="text-lowercase">http://imeet.io/invite/',print(invite_id),__p+='</h5></a>\n            </div>\n            <div class="row small-margin-top"></div>\n            <div class="row">\n               Register\n               <div class="controls">\n                   <div class="col-sm-3"></div>\n                    <div class="col-sm-6">\n                        <div class="col-sm-9">\n                            <input required type="email" class="form-control register-email" placeholder="Enter email..." data-validation="email">\n                        </div>\n                        <div class="col-sm-3">\n                            <button type="button" class="btn btn-success form-control submit-register">Go</button>\n                        </div>\n                    </div>\n                    <div class="col-sm-3"></div>\n                </div>\n           </div>\n        </div>\n    </form>\n</div>\n';return __p},this.JST["login.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div id="login-page">\n<form id="loginForm" action="/login" method="post">\n\n<div class="login-box">\n    <div class="row no-margin text-center">\n        <div class="no-padding col-md-6 col-xs-6">\n             <a href="/social_login/facebook" class="btn btn-facebook ">Login with Facebook<i class="fa fa-facebook fa-2x"></i></a>\n        </div>\n        <div class="no-padding col-md-6 col-xs-6">\n            <a href="/social_login/google"  class="btn btn-google">Login with Google<i class="fa fa-google fa-2x"></i></a>\n        </div>\n    </div>\n\n\n    <div class="row no-margin">\n        <div class="no-padding col-md-12 section-item contact-table equidistant">\n          <h4>Have an account with us?</h4>\n        </div>\n    </div>\n\n    <div class="row no-margin">\n        <div class="no-padding col-md-12">\n            <input id="username" name="username" required type="text" class="form-control " placeholder="Username">\n        </div>\n    </div>\n\n    <div class="row no-margin">\n        <div class="no-padding col-md-12">\n            <input id="password" name="password" required type="password" class="form-control " placeholder="Password">\n        </div>\n    </div>\n\n    <div class="row no-margin">\n        <div class="no-padding col-md-12">\n            <label class="remember pull-right" style="padding: 10px">\n                Remember me?\n                <input type="checkbox" name="remember_me" id="remember_me" value="on">\n              </label>\n        </div>\n    </div>\n\n     <div class="row no-margin">\n          <div class="col-sm-12 no-padding">\n              <button type="submit" class="btn btn-success form-control pull-right">Login</button>\n          </div>\n      </div>\n\n    <div class="row no-margin">\n        <div class="no-padding col-md-12">\n            <label class="remember pull-right">\n              Don\'t have an account?\n              <a href="/register" class="btn">Sign Up - It\'s Free.</a>\n            </label>\n        </div>\n    </div>\n</div>\n</form>\n</div>';return __p},this.JST["palette.html"]=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="palette-modal">\n    <div class="row no-margin palette">\n        ',_.each(palette,function(a){__p+='\n          <div class="palette-item" style="background-color: '+__e(a.background_color)+'" data-color="'+__e(a.background_color)+'" data-text="'+__e(a.color)+'"></div>\n        '}),__p+="\n    </div>\n</div>";return __p},this.JST["profile_edit.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div id="edit-profile-view">\n\n    <div class="row no-margin">\n        <div class="col-xs-12 no-padding">\n           <h4>Edit your profile</h4>\n       </div>\n    </div>\n\n    <div class="row no-margin">\n       <div class="col-xs-12 no-padding">\n           <div id="edit-profile-email"></div>\n       </div>\n    </div>\n\n    <div class="row no-margin">\n       <div class="col-xs-12 no-padding">\n        <input id="edit-profile-name" type="text" class="form-control valid-before-submit" placeholder="John Smith..." data-validation="required">\n       </div>\n    </div>\n\n    <div class="row no-margin username-row">\n        <div class="col-xs-12 no-padding">\n            <input id="edit-profile-username" type="text" class="form-control valid-before-submit" placeholder="username..." data-validation="required">\n        </div>\n    </div>\n\n    <div class="row no-margin password-row">\n        <div class="col-xs-12 no-padding">\n            <input id="edit_profile_password" name="edit_profile_password" type="password" class="form-control" placeholder="password...">\n        </div>\n    </div>\n\n    <div class="row no-margin">\n        <div class="col-xs-12 no-padding">\n            <input name="edit_profile_password_confirm" id="edit_profile_password_confirm" type="password" class="form-control" placeholder=" confirm password...">\n        </div>\n    </div>\n\n    <div class="row no-margin button-row">\n        <div class="col-xs-12 no-padding">\n            <button type=\'button\' class=\'save-profile btn btn-info form-control\'>Save</button>\n        </div>\n    </div>\n\n</div>\n';return __p},this.JST["register.html"]=function(obj){obj||(obj={});var __p="";_.escape;with(obj)__p+='<div class="signup-container">\n    <div class="signup">\n        <h4>I want in!</h4>\n       <div class="row controls">\n           <div class="col-sm-3"></div>\n            <div class="col-sm-6">\n                <div class="col-sm-9">\n                    <input required type="email" class="form-control register-email" placeholder="Enter email..." data-validation="email">\n                </div>\n                <div class="col-sm-3">\n                    <button type="button" class="btn btn-success form-control submit-register">Go</button>\n                </div>\n            </div>\n            <div class="col-sm-3"></div>\n        </div>\n    </div>\n</div>\n\n<!-- Footer -->\n<div class="section-container footer desktop navbar-fixed-bottom">\n<div class="footer-below">\n    <div class="container">\n      <div class="row">\n          <div class="col-lg-12">\n              Miami, FL<br/>\n              Copyright 2014 &copy; iMeet Inc. All rights reserved.\n          </div>\n      </div>\n    </div>\n</div>\n</div>\n';return __p},String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}),Backbone.Model.prototype.toJSON2=function(){var a=_.clone(this.attributes);for(var b in a)(a[b]instanceof Backbone.Model||a[b]instanceof Backbone.Collection)&&(a[b]=a[b].toJSON());return a};var validator={digitsRegex:new RegExp("^[0-9]{10}$"),charsRegex:new RegExp(".*"),emailRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,validateItems:function(a){var b=!0,c=$(a);return c.each(function(a){var d=$(c[a]);b=validator.validateItem(d)&&b}),b},validateString:function(a,b){var c=!1;switch(b){case"required":c=a.length>0;break;case"digits":c=validator.digitsRegex.test(a);break;case"non_numerics":c=validator.charsRegex.test(a);break;case"email":c=0==a.length||validator.emailRegex.test(a);break;case"phone":c=validator.digitsRegex.test(a)||0==a.length;break;case"date":var d=new Date(a);c=d instanceof Date&&!isNaN(d.valueOf());break;case"time":c=!0}return c},validateItem:function(a){var b=!0,c=a.data("validation");return c.split(",").forEach(function(c){var d=-1;if(c.indexOf(":")>=0){var e=c.split(":");c=e[0],d=parseInt(e[1])}var f;try{var g=a.val();if(a.is(":checkbox")&&(a.is(":checked")||(g="")),-1!=c.indexOf("|")){var h=function(a,b){var b=c.split("|"),d=a.split(",");if(0==d.length||0==b.length)return!0;var e=!0;return d.forEach(function(a){a=a.trim();var c=!1;b.forEach(function(b){c=validator.validateString(a,b)||c}),e=e&&c}),e};f=h(g,c)}else f=validator.validateString(g,c);-1!=d&&(f=f&&g.length==d)}catch(i){f=!1}b=f&&b}),a.is(":checkbox")&&(a=a.parent()),b?this.succeedValidationForItem(a):this.errorValidationForItem(a),b},errorValidationForItem:function(a){this.validationUI(a,!0)},succeedValidationForItem:function(a){this.validationUI(a,!1)},validationUI:function(a,b){b?a.addClass("failed-validation"):a.removeClass("failed-validation");var c=a.data("validation-siblings");null!=c&&c.split(",").forEach(function(a){var c=$(a);b?c.addClass("failed-validation"):c.removeClass("failed-validation")})}},randomColor=function(){for(var a="0123456789ABCDEF".split(""),b="",c=0;6>c;c++)b+=a[Math.floor(16*Math.random())];return b},cut=function(a,b){return null==b&&(b=8),a.length>=b?a.substring(0,b)+"...":a},colorInverter=function(a){if(6!=a.length)return console.error("Hex color must be six hex numbers in length."),!1;a=a.toUpperCase();var b=a.split(""),c="",d="FEDCBA9876".split(""),e=new Array;for(e.A="5",e.B="4",e.C="3",e.D="2",e.E="1",e.F="0",i=0;i<6;i++)if(isNaN(b[i])){if(!e[b[i]])return console.error("Hex colors must only include hex numbers 0-9, and A-F"),!1;c+=e[b[i]]}else c+=d[b[i]];return c};window.partial=function(a,b){return JST[a](b)};var fetchGroupDistributionForCurrentUser=function(a){null==currentUser?a({contacts:[],groups:[]}):$.ajax({url:"/api/contacts/groups?user_id="+currentUser.id,type:"GET",success:function(b){null!=a&&a(b)},error:function(a){}})};IMeetCollection=Backbone.Collection.extend({getById:function(a){var b=this.filter(function(b){return b.get("unique_id")===a});return b.length>0?b[0]:null},removeBy:function(a){this.remove(this.getById(a))},collectionToJSON:function(){return this.map(function(a){return a.toJSON2()})}}),Contact=Backbone.Model.extend({defaults:{unique_id:"",invite_attendee_id:"",name:"",email:"",phone:""},includeInInvite:function(a,b){var c=this,d="/api/invite/"+a+"/attendees/",e=[this.toJSON()],f={attendees:e};null!=currentUser&&(f.user_id=currentUser.id),$.ajax({url:d,type:"POST",contentType:"application/json",data:JSON.stringify(f),cache:!1,success:function(a){c.set("invite_attendee_id",a[0]),b&&b(c)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},removeFromInvite:function(a,b){var c="/api/invite/"+a+"/attendees/"+this.get("invite_attendee_id");$.ajax({url:c,type:"DELETE",contentType:"application/json",cache:!1,success:function(a){null!=b&&b(a)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},acknowledgeInvite:function(a,b){var c="/api/invite/attendees/"+this.get("invite_attendee_id")+"/response",d={response:a,channel:"web"};$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify(d),cache:!1,success:function(a){null!=b&&b(a)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},create:function(a){var b=this,c={contact:this.toJSON()};null!=currentUser&&(c.user_id=currentUser.id),$.ajax({url:"/api/contacts",type:"POST",contentType:"application/json",data:JSON.stringify(c),cache:!1,success:function(c){b.set("unique_id",c),null!=a&&a(c)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},update:function(a){var b=this.get("unique_id");if(null==b||""==b)return this.create(a);var c={contact:{name:this.get("name"),email:this.get("email"),phone:this.get("phone")}};null!=currentUser&&(c.user_id=currentUser.id),$.ajax({url:"/api/contacts/"+b+"/edit",data:JSON.stringify(c),type:"PUT",contentType:"application/json",cache:!1,success:function(b){null!=a&&a(b)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},updateAttendee:function(a,b){var c="/api/invite/"+a+"/attendee/",d={invite_attendee_id:this.get("invite_attendee_id"),contact:{unique_id:this.get("unique_id"),name:this.get("name"),email:this.get("email"),phone:this.get("phone")}};null!=currentUser&&(d.user_id=currentUser.id),$.ajax({url:c,type:"PUT",contentType:"application/json",data:JSON.stringify(d),cache:!1,success:function(a){b&&b(a)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},deleteContact:function(a){var b=this.get("unique_id");$.ajax({url:"/api/contacts/"+currentUser.id+"/delete/"+b,type:"DELETE",contentType:"application/json",cache:!1,success:function(b){null!=a&&a(b)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},someIdentifier:function(){var a=this.get("name");return null!=a&&""!==a?a:(a=this.get("email"),null!=a&&""!==a?a:a=this.get("phone"))},addToGroup:function(a,b){$.ajax({url:"/api/group/"+a+"/"+this.get("unique_id")+"?user_id="+currentUser.id,type:"POST",contentType:"application/json",success:function(a){null!=b&&b(a)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}),ContactList=IMeetCollection.extend({model:Contact,getByAttendeeId:function(a){var b=this.filter(function(b){return b.get("invite_attendee_id")===a});return b.length>0?b[0]:null}}),Group=Backbone.Model.extend({defaults:{unique_id:"",name:"",contacts:new ContactList},create:function(a){var b=this,c={contact:this.toJSON()};null!=currentUser&&(c.user_id=currentUser.id),$.ajax({url:"/api/group/"+this.get("name"),type:"POST",contentType:"application/json",data:JSON.stringify(c),cache:!1,success:function(c){b.set("unique_id",c),null!=a&&a(c)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},update:function(a){var b=this.get("unique_id");if(null==b||""==b)return this.create(a);var c={group:{name:this.get("name")}};null!=currentUser&&(c.user_id=currentUser.id),$.ajax({url:"/api/group/"+b+"/edit",data:JSON.stringify(c),type:"PUT",contentType:"application/json",cache:!1,success:function(b){null!=a&&a(b)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},fetchContacts:function(a){var b=this;$.ajax({url:"/api/group/"+this.get("unique_id")+"?user_id="+currentUser.id,type:"GET",success:function(c){var d=new ContactList;null!=c&&c.forEach(function(a){d.add(new Contact(a))}),b.set("contacts",d),null!=a&&a(d)},error:function(a){alert_notification([{alertType:"danger",message:"There was an error getting the contacts for the group"}])}})},includeInInvite:function(a,b){var c=this,d="/api/invite/"+a+"/group/",e={unique_id:this.get("unique_id")};null!=currentUser&&(e.user_id=currentUser.id),$.ajax({url:d,type:"POST",contentType:"application/json",data:JSON.stringify(e),cache:!1,success:function(a){var d=0,e=c.get("contacts");a.forEach(function(a){e.models[d].set("invite_attendee_id",a)}),null!=b&&b(c.get("contacts"))},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},fetchAllGroups:function(a){var b={};null!=currentUser&&$.ajax({url:"/api/group?user_id="+currentUser.id,type:"GET",contentType:"application/json",data:JSON.stringify(b),cache:!1,success:function(b){null!=a&&a(b)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}),GroupList=IMeetCollection.extend({model:Group,localStorage:new Store("backbone-group")}),InviteModel=Backbone.Model.extend({defaults:{unique_id:"",title:"",start_date:"",start_time:"",end_date:"",end_time:"",description:"",where:"",poster_image_id:"",attendees:new ContactList,all_contacts:new ContactList,all_groups:new ContactList,utc_offset:0},initialize:function(a){if(null!=a){var b=this.parse_datetime(a.start),c=this.parse_datetime(a.end);this.set("start_date",b.date),this.set("start_time",b.time),this.set("end_date",c.date),this.set("end_time",c.time);var d=new ContactList;null!=a.attendees&&a.attendees.forEach(function(a){d.push(new Contact(a))}),this.set("attendees",d)}},format_date:function(a,b){var c=this.get(a);return isNullOrEmpty(c)?null:moment(c).format(b)},get_datetime:function(a){var b=this.get(a+"_time"),c=this.get(a+"_date");return isNullOrEmpty(b)||isNullOrEmpty(c)?null:c+" "+b},parse_datetime:function(a){if(isNullOrEmpty(a))return{date:null,time:null};var b=moment(a);return{date:b.format("MM/D/YYYY"),time:b.format("hh:mm A")}},toJSON:function(){var a=Backbone.Model.prototype.toJSON.apply(this,arguments);return a.start=this.get_datetime("start"),a.end=this.get_datetime("end"),a},fetch:function(a){var b=this;$.ajax({url:"/api/invite/"+this.get("unique_id"),type:"GET",cache:!1,success:function(c){a(b.get("unique_id"),c)}})},updateTitle:function(a,b){var c="/api/invite/"+this.get("unique_id")+"/title";$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify({title:this.get("title")}),cache:!1,success:function(c){b&&alert_notification([{alertType:"success",message:"Event saved successfully!"}],3e3),a(c)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},updateDescription:function(a,b){var c="/api/invite/"+this.get("unique_id")+"/description";$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify({description:this.get("description")}),cache:!1,success:function(c){b&&alert_notification([{alertType:"success",message:"Event saved successfully!"}],3e3),a(c)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},submit:function(a,b){var c=new Date;this.set("utc_offset",c.getTimezoneOffset());var d=this.toJSON();null!=currentUser&&(d.user_id=currentUser.id);var e="/api/invite/";null!==this.get("unique_id")&&(e+=this.get("unique_id")),$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(d),cache:!1,success:function(c){b&&alert_notification([{alertType:"success",message:"Event saved successfully!"}],3e3),a(c)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},notifyAll:function(a){var b=this.toJSON();$.ajax({url:"/api/invite/"+this.get("unique_id")+"/attendees/notify/all",type:"POST",contentType:"application/json",data:JSON.stringify(b),cache:!1,success:function(b){a(b)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},tryToObtainAttendeeFromLoggedUser:function(a){var b={};null!=currentUser&&$.ajax({url:"/api/invite/"+this.get("unique_id")+"/attendee/from/?user_id="+currentUser.id,type:"GET",contentType:"application/json",data:JSON.stringify(b),cache:!1,success:function(b){console.log(b),null!=a&&a(b)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}),InviteList=IMeetCollection.extend({model:InviteModel}),CommentModel=Backbone.Model.extend({defaults:{on:null,comment:"",author:""},initialize:function(a){"string"==typeof a&&this.set("comment",a)},submit:function(a,b){var c="/api/invite/{0}/comment".format(a);null!=b&&(c="/api/invite/{0}/attendees/{1}/comment".format(a,b)),$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify({comment:this.get("comment")}),cache:!1,success:function(a){},error:function(a){200!=a.status&&alert_notification([{alertType:"danger",message:a.responseText}])}})}}),CommentList=IMeetCollection.extend({model:CommentModel,fetchFromInvite:function(a){$.ajax({url:"/api/invite/{0}/comment".format(a),type:"GET",contentType:"application/json",cache:!1,success:function(a){var b=new CommentList;return a.forEach(function(a){b.add(new CommentModel(a))}),b},error:function(a){}})}}),SimpleView=Backbone.View.extend({initialize:function(a){this.options=a||{}},hidePanels:function(){$("#body-container").hide(),$("#view-container").show(),$("#modal_container").hide(),$("#invite-body").hide()},clearTemplate:function(){$("#view-container").html("")},block:function(a,b){var c=$(window).height();"half"===b?c/=2:"quarter"==b?c/=3:c=c,$(a).css("height",c)}});var _contactCreateView=null;ContactsView=SimpleView.extend({first_time:!0,el:"#contact-list",template:JST["contacts.html"],initialize:function(a){this.options=a||{}},events:{"click .add-contact":"addContact","change #import-csv":"importFromCsv","click .navigate-to-groups":"navigateToGroups","click .add-to-group":"addToGroup","mouseup div":"mouseUp"},render:function(a){this.contactList=a.contactList,this.groupList=a.groupList,this.listenTo(this.contactList,"add",this.addContactHook),this.listenTo(this.contactList,"remove",this.removeContactHook),this.listenTo(this.contactList,"change",this.changeContactHook),this.$el.html(this.template());var b=this.$el.find("#contacts_table");contactList.each(function(a){b.append(new ContactItemView({model:a}).render().el)}),this.first_time=!1},addContactHook:function(a){var b=$("#contacts_table");b.append(new ContactItemView({model:a}).render().el)},removeContactHook:function(a){var b=$('div[data-id="'+a.get("unique_id")+'"');b.remove()},changeContactHook:function(a){var b=$('div[data-id="'+a.get("unique_id")+'"');b.html($(JST["contact_item.html"](a.toJSON())).html())},addContact:function(a){a.preventDefault(),this.contactCreateView=contactCreateView(),this.contactCreateView.render(null,this.contactList)},importFromCsv:function(a){var b=new FileReader;b.onload=function(a,b){return function(b){$.ajax({url:"/api/contacts/csv",type:"POST",contentType:"application/json",data:'{"user_id" : "{0}", "file_name": "{1}", "file": "{2}"}'.format(currentUser.id,a.name,b.target.result),cache:!1,success:function(){location.reload(),console.info("file uploaded correctly.")},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}(a.target.files[0],this),b.readAsDataURL(a.target.files[0])},navigateToGroups:function(){Backbone.history.navigate("groups",!0)}}),ContactDetailsView=Backbone.View.extend({template:JST["contact_details.html"],el:"#new-contact-container",createMode:!0,mainContactList:null,events:{"click .new-contact-btn":"newContact"},render:function(a,b){if(this.mainContactList=b,this.createMode=null==a,this.model=a||new Contact,this.$el.html(this.template({createMode:this.createMode,contact:this.model.toJSON()})),!this.createMode){var c=new GroupSearchView({el:".contact-groups"});c.render(a,!1)}return this.$el.find(".addContact-modal").modal({show:!0,backdrop:!0,keyboard:!0}),this.$el},show:function(){this.$el.find(".addContact-modal").modal({show:!0,backdrop:!0,keyboard:!0})},hide:function(){this.$el.find(".addContact-modal").modal("hide")},newContact:function(){return validator.validateItems(".contact_input")?(this.model.set("name",$("#nameInput").val()),this.model.set("email",$("#emailInput").val()),this.model.set("phone",$("#phoneInput").val()),void(this.createMode?this.model.create($.proxy(this.contactCreated,this)):this.model.update($.proxy(this.contactUpdated,this)))):void alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}])},contactCreated:function(a){var b="Contact created!";alert_notification([{alertType:"success",message:b}],5),this.model.set("unique_id",a),null!=this.mainContactList&&this.mainContactList.add(this.model),this.hide()},contactUpdated:function(a){var b="Contact updated!";alert_notification([{alertType:"success",message:b}],5),this.hide()}}),ContactItemView=SimpleView.extend({template:JST["contact_item.html"],editTemplate:JST["contact_item_edit.html"],model:null,editMode:!1,events:{"dragstart .contact-row":"enterDragMode","click .contact-row":"edit","click .finish-edit":"finishEditMode","click .delete-contact":"deleteContact"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},enterDragMode:function(a){var b=this.model.get("unique_id");a.originalEvent.dataTransfer.setData("contact_id",b)},edit:function(a){a.preventDefault(),this.contactCreateView=contactCreateView(),this.contactCreateView.render(this.model)},deleteContact:function(a){a.preventDefault(),a.stopPropagation(),this.model.deleteContact($.proxy(this.contactDeleted,this))},contactDeleted:function(a){}}),AttendeeDetailsView=Backbone.View.extend({template:JST["contact_details.html"],el:"#new-contact-container",invite_id:null,events:{"click .new-contact-btn":"updateAttendee"},render:function(a,b){return this.invite_id=a,this.model=b,this.$el.html(this.template({createMode:!1,contact:this.model.toJSON()})),this.$el.find(".addContact-modal").modal({show:!0,backdrop:!0,keyboard:!0}),this.$el},show:function(){this.$el.find(".addContact-modal").modal({show:!0,backdrop:!0,keyboard:!0})},hide:function(){this.$el.find(".addContact-modal").modal("hide")},updateAttendee:function(){return validator.validateItems(".contact_input")?(this.model.set("name",$("#nameInput").val()),this.model.set("email",$("#emailInput").val()),this.model.set("phone",$("#phoneInput").val()),void(null==currentUser||""!=this.model.get("unique_id")?this.model.updateAttendee(this.invite_id,$.proxy(this.attendeeUpdated,this)):this.model.create($.proxy(this.updateAttendee,this)))):void alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}])},attendeeUpdated:function(a){var b="Attendee updated!";alert_notification([{alertType:"success",message:b}],5),this.model.set("unique_id",a),this.hide()}}),GroupSearchView=Backbone.View.extend({template:JST["group_search.html"],model:null,searchMode:!1,events:{"click .add-to-group":"addToGroup","keyup .group-input":"groupInputEnter"},render:function(a,b){this.model=a;var c={searchMode:b,contact:this.model.toJSON()};this.$el.html(this.template(c)),this.$newGroup=$(".group-input");var d=this,e=new Group;return e.fetchAllGroups(function(a){d.all_groups=new GroupList(a),d.setupGroupsTypeahead(),d.$newGroup.focus()}),this},groupInputEnter:function(a){13==a.keyCode&&this.groupSelected()},groupSelected:function(){var a=this.selectedGroup;null!=a&&(this.model.get("groups").push(a),this.model.addToGroup(a.unique_id,$.proxy(this.contactIncludedInGroup,this)))},contactIncludedInGroup:function(){this.render(this.model,!1)},addToGroup:function(a){this.render(this.model,!0)},setupGroupsTypeahead:function(){var a=this,b=function(a){return function(b,c){var d,e;d=[],e=new RegExp(b,"i"),a.each(function(a){e.test(a.get("name"))&&(a.set("is_group",!0),d.push(a.toJSON()))}),c(d)}},c=function(c){a.$newGroup.typeahead({hint:!0,highlight:!0,minLength:1},{autoselect:!0,name:"groups",displayKey:"name",source:b(c),templates:{suggestion:JST["group_item_typeahead.html"]}}).on("typeahead:selected",function(b,c){a.selectedGroup=c,a.groupSelected()}).on("keypress keydown input",function(a){a.stopPropagation()})};c(a.all_groups)}});var _groupCreateView=null;GroupsView=Backbone.View.extend({first_time:!0,el:"#contact-list",template:JST["groups.html"],events:{"click .add-group":"addGroup","click .navigate-to-contacts":"navigateToContacts"},newGroupView:null,render:function(a){this.groupList=a.groupList,this.listenTo(this.groupList,"add",this.addGroupHook),this.listenTo(this.groupList,"remove",this.removeGroupHook),this.listenTo(this.groupList,"change",this.changeGroupHook),this.$el.html(this.template());var b=this.$el.find("#groups_table");this.groupList.each(function(a){b.append(new GroupItemView({model:a}).render().el)}),this.first_time=!1},addGroup:function(a){a.preventDefault(),this.groupCreateView=groupCreateView(),this.groupCreateView.render(null,this.groupList)},addGroupHook:function(a){var b=$("#groups_table");b.append(new GroupItemView({model:a}).render().el)},changeGroupHook:function(a){var b=$('div[data-id="'+a.get("unique_id")+'"');b.html($(JST["group_item.html"](a.toJSON())).html())},navigateToContacts:function(){Backbone.history.navigate("contacts",!0)}}),GroupDetailsView=Backbone.View.extend({template:JST["group_details.html"],el:"#new-group-container",createMode:!0,mainGroupList:null,events:{"click .new-group-btn":"newGroup"},render:function(a,b){return this.mainGroupList=b,this.createMode=null==a,this.model=a||new Group,this.$el.html(this.template({createMode:this.createMode,group:this.model.toJSON()})),this.$el.find(".addGroup-modal").modal({show:!0,backdrop:!0,keyboard:!0}),this.$el},show:function(){this.$el.find(".addGroup-modal").modal({show:!0,backdrop:!0,keyboard:!0})},hide:function(){this.$el.find(".addGroup-modal").modal("hide")},newGroup:function(){return validator.validateItems(".group_input")?(this.model.set("name",$("#nameInput").val()),void(this.createMode?this.model.create($.proxy(this.groupCreated,this)):this.model.update($.proxy(this.groupUpdated,this)))):void alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}])},groupCreated:function(a){var b=this.createMode?"Group created!":"Group updated!";alert_notification([{alertType:"success",message:b}],5),this.model.set("unique_id",a),null!=this.mainGroupList&&this.mainGroupList.add(this.model),this.hide()},groupUpdated:function(a){var b="Group updated!";alert_notification([{alertType:"success",message:b}],5),this.hide()}}),GroupItemView=SimpleView.extend({template:JST["group_item.html"],editTemplate:JST["group_item_edit.html"],model:null,editMode:!1,events:{"click .group-row":"edit","click .finish-edit":"finishEditMode","click .delete-group":"deleteGroup"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},edit:function(a){a.preventDefault(),this.groupCreateView=groupCreateView(),this.groupCreateView.render(this.model)},deleteGroup:function(a){a.preventDefault(),a.stopPropagation(),this.model.deleteContact($.proxy(this.groupDeleted,this))},groupDeleted:function(a){}}),IndexView=Backbone.View.extend({initialize:function(a){this.options=a||{}},events:{"click .imeet-btn":"createNew","keypress .invite-title-input":"type_key"},type_key:function(a){return 13==a.keyCode?(this.createNew(),a.preventDefault(),!1):void 0},render:function(a){$("#view-container").hide(),this.$el.show(),this.$inviteTitle=this.$el.find(".invite-title-input"),this.$headerImage=this.$el.find(".header-section")},createNew:function(){var a=this.$inviteTitle.val();null!=a&&""!=a?Backbone.history.navigate("/new/"+a,!0):alert("type a title!")}}),InviteAdminView=SimpleView.extend({template:JST["invite_admin.html"],author:"Organizer",contacts:null,current_attendee:null,initialize:function(a){this.options=a||{},this.inviteId=this.options.id},events:{"keypress .invite-newComment":"addNewComment","click .notify-all":"notifyAll","change .share_to_facebook":"share_on_facebook_auth"},hidePanels:function(){$("#body-container").hide(),$("#view-container").hide(),$("#modal_container").hide(),$("#invite-body").show()},render:function(a,b,c){if(this.hidePanels(),this.unique_id=a,null==this.unique_id&&console.error("Invite Id is null, check routing"),null==b){var d=new InviteModel({unique_id:this.unique_id});return void d.fetch($.proxy(this.render,this))}null!=c&&(this.current_attendee=new Contact(c)),this.validateInviteIsCurrent(b.start),this.model=new InviteModel(b);var e=this.model.toJSON();this.$el.html(this.template(e));var f=new InviteAttendeesView,g=new InviteDescriptionView({el:"#invite-description"}),h=new InviteHeaderView({is_admin:!0}),i=new InviteDetailsView({is_admin:!0}),j=new InviteCommentsView,k=new InviteAttendeeCreateView,l=this.model.get("attendees");f.render({invite_id:this.unique_id,attendees:l,current_attendee:this.current_attendee}),g.render(this.model),h.render(this.model),i.render(this.model),j.render({invite_id:this.unique_id,current_attendee:this.current_attendee,comments:new CommentList(b.comments)}),k.render(this.unique_id,l),$(".invite-description").html(b.description),this.plugins()},notifyAll:function(){this.model.notifyAll($.proxy(this.notifyAllCallback,this))},notifyAllCallback:function(a){alert_notification([{alertType:"success",message:"Everyone in the invite is going to be notified in the next few minutes"}],5e3)},plugins:function(){var a=this;a.block(".invite-background","half"),$(window).resize(function(){a.block(".invite-background","half")})},validateInviteIsCurrent:function(a){var b=moment(a),c=moment();c>b&&alert_notification([{alertType:"warning",message:"This invite is in the Past you cannot edit it anymore"}],5e3)}}),InviteAttendeeCreateView=Backbone.View.extend({template:JST["invite_attendee_create.html"],el:"#invite-new-attendee",
initialize:function(a){this.options=a||{}},events:{"click .new-contact-button":"createNewAttendee","keyup .contact-input":"newAttendeeEnter"},render:function(a,b){this.model=b,this.invite_id=a;var c={};this.$el.html(this.template(c)),this.$newContact=$(".contact-input");var d=this;fetchGroupDistributionForCurrentUser(function(a){d.all_contacts=new ContactList(a.contacts),d.all_groups=new GroupList(a.groups),d.setupContactsTypeahead()})},newAttendeeEnter:function(a){13==a.keyCode&&this.createNewAttendee()},createNewAttendee:function(){var a=null,b=null;if(null!=this.last_selected_item&&this.last_selected_item.is_group?b=this.last_selected_item:null!=this.last_selected_item&&(a=this.last_selected_item),null==this.last_selected_item&&""!=this.$newContact.val()){if(!validator.validateItem(this.$newContact))return void alert_notification([{alertType:"warning",message:"Please ensure this is a correct address, or a contact selected from your contact book"}]);var c=this.parsePhoneAndEmail(this.$newContact.val());a={name:"",email:c.email,phone:c.phone}}if(null!=a){var d=new Contact(a);d.includeInInvite(this.invite_id,$.proxy(this.addAttendee,this))}if(null!=b){var b=new Group({unique_id:b.unique_id});b.fetchContacts(),b.includeInInvite(this.invite_id,$.proxy(this.addAttendeesFromGroup,this))}this.last_selected_item=null,this.$newContact.val(""),this.$newContact.typeahead("val",""),this.$newContact.focus()},addAttendee:function(a){this.model.add(a)},addAttendeesFromGroup:function(a){var b=this;a.forEach(function(a){b.model.add(a)})},setupContactsTypeahead:function(){var a=this,b=function(a){return function(b,c){var d,e;d=[],e=new RegExp(b,"i"),a.each(function(a){(e.test(a.get("name"))||e.test(a.get("email"))||e.test(a.get("phone")))&&d.push(a.toJSON())}),c(d)}},c=function(a){return function(b,c){var d,e;d=[],e=new RegExp(b,"i"),a.each(function(a){e.test(a.get("name"))&&(a.set("is_group",!0),d.push(a.toJSON()))}),c(d)}},d=function(d,e){a.$newContact.typeahead({hint:!0,highlight:!0,minLength:1},{autoselect:!0,name:"groups",displayKey:"name",source:c(e),templates:{suggestion:JST["group_item_typeahead.html"]}},{autoselect:!0,name:"contacts",displayKey:"name",source:b(d),templates:{suggestion:JST["contact_item_typeahead.html"]}}).on("typeahead:selected",function(b,c){a.last_selected_item=c}).on("keypress keydown input",function(a){a.stopPropagation()})};d(a.all_contacts,a.all_groups)},parsePhoneAndEmail:function(a){var b=(a.trim(),a.split(";"));1==b.length&&(b=a.split(","));for(var c=0;c<b.length;c++)b[c]=b[c].trim();return 1==b.length?isNaN(b[0])?{email:b[0],phone:""}:{phone:b[0],email:""}:isNaN(b[0])?{email:b[0],phone:b[1]}:{phone:b[0],email:b[1]}}}),InviteAttendeesView=Backbone.View.extend({template:JST["invite_attendees.html"],el:"#invite-attendees",confirmed:null,negated:null,no_response:null,current_attendee:null,initialize:function(a){this.options=a||{}},events:{"click .invite-attendees-acknowledge-yes":"yesButtonClick","click .invite-attendees-acknowledge-no":"noButtonClick","click .edit-attendee":"editAttendeeClick"},render:function(a){this.model=a.attendees,this.current_attendee=a.current_attendee,this.invite_id=a.invite_id,this.separateAttendees();var b={no_response:this.no_response.collectionToJSON(),confirmed:this.confirmed.collectionToJSON(),negated:this.negated.collectionToJSON(),attendee:null!=this.current_attendee?this.current_attendee.toJSON():null};return this.$el.html(this.template(b)),this.$table=this.$el.find(".contact-table"),this.$newContact=$(".contact-input"),this.listenTo(this.model,"add",this.attendeeCreated),this.listenTo(this.model,"remove",this.attendeeRemoved),this.listenTo(this.model,"change",this.attendeeUpdated),this.$el.html()},separateAttendees:function(){this.no_response=new ContactList,this.negated=new ContactList,this.confirmed=new ContactList;var a=this;this.model.forEach(function(b){var c=b.get("status");"yes"==c?a.confirmed.add(b):"no"==c?a.negated.add(b):"organizer"==c?(b.set("organizer",!0),a.confirmed.add(b)):a.no_response.add(b)})},attendeeCreated:function(a){this.no_response.add(a),$(".no-response-table").prepend(JST["invite_attendee_admin.html"](a.toJSON()))},attendeeRemoved:function(a){var b=$(a.currentTarget).data("rowid"),c=this.model.getById(b);c.removeFromInvite(this.invite_id),this.model.removeBy(b)},attendeeUpdated:function(a){var b=$('a[data-rowid="'+a.get("invite_attendee_id")+'"');b.html($(JST["invite_attendee_admin.html"](a.toJSON())).html())},yesButtonClick:function(a){this.attendeeRSVP("yes")},noButtonClick:function(a){this.attendeeRSVP("no")},attendeeRSVP:function(a){return null==this.current_attendee?void alert_notification([{alertType:"danger",message:"Something wrong happened, you shouldnt be able to SAY "+a+" You are nobody!!!"}]):(this.current_attendee.set("status",a),void this.current_attendee.acknowledgeInvite(a,$.proxy(this.attendeeRSVPCallback,this)))},attendeeRSVPCallback:function(){var a=this.model.getById(this.current_attendee.get("unique_id"));a.set("status",this.current_attendee.get("status")),this.render({attendees:this.model,current_attendee:this.current_attendee})},attendeeDetailsView:function(){return null==this._attendeeDetailsView&&(this._attendeeDetailsView=new AttendeeDetailsView),this._attendeeDetailsView},editAttendeeClick:function(a){var b=$(a.currentTarget).data("rowid"),c=this.model.getByAttendeeId(b),d=this.attendeeDetailsView();d.render(this.invite_id,c)}}),InviteCommentsView=Backbone.View.extend({template:JST["invite_comments.html"],el:"#invite-comments",invite_id:null,current_attendee:null,initialize:function(a){this.options=a||{}},events:{"click .add-comment":"addComment","keyup .invite-comment-input":"addCommentEnter"},render:function(a){this.invite_id=a.invite_id,this.current_attendee=a.current_attendee,this.model=a.comments;var b={current_attendee:this.current_attendee,comments:this.model.collectionToJSON()};if(null==this.current_attendee&&null!=currentUser){var c=new InviteModel({unique_id:this.invite_id});c.tryToObtainAttendeeFromLoggedUser($.proxy(this.attendeeFromUser,this))}this.$el.html(this.template(b)),this.$comment_container=this.$el.find(".invite-comments-container"),this.$comment_input=this.$el.find(".invite-comment-input"),this.listenTo(this.model,"add",this.newCommentModel)},attendeeFromUser:function(a){"undefined"!=typeof a&&(this.current_attendee=new Contact(a),null!=this.current_attendee&&($(".comment-box").html(JST["invite_comment_box.html"]()),this.$comment_container=this.$el.find(".invite-comments-container"),this.$comment_input=this.$el.find(".invite-comment-input")))},addCommentEnter:function(a){13==a.keyCode&&this.addComment()},addComment:function(){if(""!=this.$comment_input.val()){var a=new CommentModel({comment:this.$comment_input.val(),author:this.current_attendee.someIdentifier()});a.submit(this.invite_id,this.current_attendee.get("invite_attendee_id")),this.model.add(a),this.$comment_input.val(""),this.$comment_input.focus()}},newCommentModel:function(a){this.$comment_container.prepend(JST["invite_comment.html"](a.toJSON()))}}),InviteCreateView=SimpleView.extend({el:"#view-container",initialize:function(a){this.options=a||{},this.model=new InviteModel},events:{"click .send":"submitNew","change .share_to_facebook":"share_on_facebook_auth"},bindings:{".event-name":"title",".event-name-input":"title",".event-description":"description",".event-description-input":"description",".event-where":"where",".event-location-input":"where",".event-start-date":"start_date",".event-start-time":"start_time",".event-end-date":"end_date",".event-end-time":"end_time"},template:JST["invite_create.html"],contacts:null,render:function(a){return this.hidePanels(),null!=a.title&&this.model.set("title",a.title),null!=a.id&&this.createFromInvite(a.id),this.$el.html(this.template(this.model.toJSON())),this.plugins(),this.stickit(),this},createFromInvite:function(a){var b=this;$.ajax({url:"/api/invite/"+a,type:"GET",cache:!1,success:function(a){b.model=new InviteModel(a),b.model.set("unique_id",""),b.render(a)},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})},submitNew:function(a){return validator.validateItems(".valid-before-submit")?void this.model.submit($.proxy(this.inviteSubmitted,this),!0):void alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}])},inviteSubmitted:function(a){Backbone.history.navigate("invite/"+a+"/edit",!0)},share_on_facebook_auth:function(){null!=currentUser&&currentUser.social_sharing.facebook||!$("#bt_toggle").is(":checked")||window.open(api.url+"/social_sharing/facebook","_blank","toolbar=yes, scrollbars=no, resizable=yes, top=500, left=500")},plugins:function(){$("#bt_toggle").bootstrapToggle(),this.$el.find(".event-start-date, .event-end-date").datetimepicker({pickTime:!1,minDate:moment()}),this.$el.find(".event-start-time, .event-end-time").datetimepicker({pickDate:!1}),this.initWhere()},initWhere:function(){var a=this;if("undefined"!=typeof google){this.$where=this.$el.find(".event-location-input"),autocomplete=new google.maps.places.Autocomplete(a.$where[0],{types:["geocode"]});var b=function(){var b=autocomplete.getPlace();a.model.set("where",b.formatted_address)};google.maps.event.addListener(autocomplete,"place_changed",function(){b()})}},geoLocateWhere:function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){var b=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),c=new google.maps.Circle({center:b,radius:a.coords.accuracy});autocomplete.setBounds(c.getBounds())})}}),InviteDescriptionView=Backbone.View.extend({is_editable:!0,initialize:function(a){this.options=a||{}},render:function(a,b){var c=this;if(this.model=a,b){var d='<textarea type="text" class="edit-invite-description-input">'+c.model.get("description")+"</textarea>";this.$el.html(d),this.$input=this.$el.find(".edit-invite-description-input");var e=function(a){c.model.set("description",a),c.model.updateDescription($.proxy(c.submitSuccess,c))};this.$input.on("blur",function(){e(c.$input.val())}),this.$input.on("keyup",function(a){13==a.keyCode&&e(c.$input.val())})}else{var f='<span class="editable invite-description-value">'+c.model.get("description")+"</span>";if(this.$el.html(f),this.is_editable){var g=this.$el.find(".invite-description-value");g.on("click",function(){c.render(c.model,!0)})}}},submitSuccess:function(a){this.render(this.model,!1)}}),InviteDetailsView=SimpleView.extend({template:JST["invite_details.html"],el:"#invite-details",bindings:{".event-name":"title",".event-name-input":"title",".event-description":"description",".event-description-input":"description",".event-where":"where",".event-location-input":"where",".event-start-date":"start_date",".event-start-time":"start_time",".event-end-date":"end_date",".event-end-time":"end_time"},initialize:function(a){this.options=a||{},this.inviteId=this.options.id},events:{"click .invite-date":"edit_start_date","click .invite-end-date":"edit_end_date","click .location-title":"edit_location","click .details-row":"showPalette","click .edit_invite":"editInvite","click .save_invite":"saveInvite"},render:function(a,b){this.edit_view=b,this.model=a;var c=this.model.toJSON();c.is_admin=this.options.is_admin,c.is_edit=b,this.$el.html(this.template(c)),b?(this.edit_plugins(),this.stickit()):this.read_plugins()},editInvite:function(){this.render(this.model,!0)},saveInvite:function(){return validator.validateItems(".valid-before-submit")&&(""==$(".event-end-date").val()&&""==$(".event-end-time").val()||validator.validateItems(".event-end-date, .event-end-time"))?void this.model.submit($.proxy(this.submitSuccess,this)):void alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}])},submitSuccess:function(a){this.render(this.model,!1)},read_plugins:function(){$("#bt_toggle").bootstrapToggle()},edit_plugins:function(){this.$el.find(".event-start-date, .event-end-date").datetimepicker({pickTime:!1}),this.$el.find(".event-start-time, .event-end-time").datetimepicker({pickDate:!1}),this.initWhere(),$("#bt_toggle").bootstrapToggle()},initWhere:function(){var a=this;if("undefined"!=typeof google){a.$where=this.$el.find(".event-location-input"),autocomplete=new google.maps.places.Autocomplete(a.$where[0],{types:["geocode"]});var b=function(){var b=autocomplete.getPlace();a.model.set("where",b.formatted_address)};google.maps.event.addListener(autocomplete,"place_changed",function(){b()})}},geoLocateWhere:function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){var b=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),c=new google.maps.Circle({center:b,radius:a.coords.accuracy});autocomplete.setBounds(c.getBounds())})},share_on_facebook_auth:function(){null!=currentUser&&currentUser.social_sharing.facebook||!$("#bt_toggle").is(":checked")||window.open(api.url+"/social_sharing/facebook","_blank","toolbar=yes, scrollbars=no, resizable=yes, top=500, left=500")},showPalette:function(){if(this.edit_view){var a=new PaletteView;a.render()}}}),InviteHeaderView=SimpleView.extend({template:JST["invite_header.html"],el:"#invite-header",initialize:function(a){this.options=a||{}},events:{"#upload_image_file change":"image_changed"},upload_image:function(a){var b=$("#upload_image_form"),c=$(".invite-background");$.ajax({url:a,type:"POST",data:new FormData(b[0]),processData:!1,contentType:!1,success:function(a){var b="/image/"+a+"?"+(new Date).getTime();c.css("background-image","url("+b+")")},error:function(a){alert_notification([{alertType:"danger",message:"Image couldnt be uploaded"}])}})},render:function(a){this.model=a;var b=this.model.toJSON();this.$el.html(this.template(b)),this.options.is_admin?$("#image_select_btn").show():$("#image_select_btn").hide(),this.$image_file=this.$el.find("#upload_image_file"),this.$image_form=this.$el.find("#upload_image_form");var c=this,d=new InviteTitleView({el:".invite-title-container",is_editable:this.options.is_admin});d.render(this.model),this.$image_file.on("change",function(){$.ajax({url:"/image/"+c.$image_form.data("id")+"/upload_url",type:"GET",success:function(a){c.upload_image(a)},error:function(a){alert_notification([{alertType:"danger",message:"Image couldnt be uploaded"}])}})}),this.$el.find("#image_select_btn").click(function(){c.$image_file.click()})}}),InviteTitleView=Backbone.View.extend({initialize:function(a){this.options=a||{is_editable:!1}},render:function(a,b){var c=this;if(this.model=a,b){var d='<input type="text" class="edit-title-input palette-editable" data-opacity="0.7" value="'+c.model.get("title")+'">';this.$el.html(d),this.$input=this.$el.find(".edit-title-input");var e=function(a){c.model.set("title",a),c.model.updateTitle($.proxy(c.submitSuccess,c))};this.$input.on("blur",function(){e(c.$input.val())}),this.$input.on("keyup",function(a){13==a.keyCode&&e(c.$input.val())})}else{var f='<h1 class="main-h1 palette-editable" data-opacity="0.7">'+c.model.get("title")+"</h1>";if(this.$el.html(f),this.options.is_editable){console.log("Editable");var g=this.$el.find(".main-h1");g.addClass("editable"),g.on("click",function(){c.render(c.model,!0)})}}},submitSuccess:function(a){this.render(this.model,!1)}}),SearchView=SimpleView.extend({template:JST["invite_search.html"],initialize:function(a){this.options=a||{}},events:{"click .search":"search_value","keypress #searchBox":"type_key","click .btn-duplicate":"duplicate","click .btn-edit":"edit","click .btn-cancel":"cancel","click .invite-background":"navigate"},render:function(a,b){if(this.hidePanels(),this.model=a,null!=this.model?this.$el.html(this.template({invites:this.model.collectionToJSON()})):(this.$el.html(this.template({invites:{}})),this.search()),null!=b){var c=this.$el.find("#searchBox");c.val(b),c.focus()}this.plugins()},type_key:function(a){if(13==a.keyCode){var b=this.$el.find("#searchBox");return this.search(b.val()),a.preventDefault(),!1}},search_value:function(a){var b=this.$el.find("#searchBox");this.search(b.val())},search:function(a){var b=this,c="/api/invite/search/"+currentUser.id+"?term=";null!=a&&(c+=a),$.ajax({url:c,type:"GET",cache:!1,success:function(c){var d=new InviteList;null!=c&&c.forEach(function(a){d.add(new InviteModel(a))}),b.render(d,a)}})},duplicate:function(a){a.preventDefault(),a.stopPropagation();var b=$(a.target),c=b.data("id");Backbone.history.navigate("new/from/"+c,!0)},edit:function(a){a.preventDefault(),a.stopPropagation();var b=$(a.target),c=b.data("id");Backbone.history.navigate("invite/"+c+"/edit",!0)},navigate:function(a){console.log(a);var b=$(a.target),c=b.data("id");Backbone.history.navigate("invite/"+c,!0)},cancel:function(a){alert("not ready yet")},plugins:function(){var a=this;a.block(".invite-background","half"),$(window).resize(function(){a.block(".invite-background","half")})}}),InviteView=SimpleView.extend({template:JST["invite.html"],invite_id:null,current_attendee:null,initialize:function(a){this.options=a||{},this.inviteId=this.options.id},hidePanels:function(){$("#body-container").hide(),$("#view-container").hide(),$("#modal_container").hide(),$("#invite-body").show()},render:function(a,b,c){this.hidePanels();if(this.invite_id=a,null!=c&&(this.current_attendee=new Contact(c)),null==this.invite_id&&console.error("Invite Id is null, check routing"),null==b){var d=new InviteModel({unique_id:this.invite_id});return void d.fetch($.proxy(this.render,this))}var d=new InviteModel(b);this.$el.html(this.template());var e=new InviteHeaderView,f=new InviteDetailsView,g=new InviteAttendeesView,h=new InviteCommentsView;e.render(d),f.render(d),g.render({invite_id:this.invite_id,attendees:d.get("attendees"),current_attendee:this.current_attendee}),h.render({invite_id:this.invite_id,current_attendee:this.current_attendee,comments:new CommentList(b.comments)}),$(".invite-description").html(b.description),this.plugins()},events:{"keypress .invite-newComment":"addNewComment"},plugins:function(){var a=this;a.block(".invite-background","half"),$(window).resize(function(){a.block(".invite-background","half")})}}),LoginView=SimpleView.extend({template:JST["login.html"],render:function(a){this.hidePanels(),this.$el.html(this.template())}}),ModalView=Backbone.View.extend({childView:null,template:null,initialize:function(a){this.options=a||{},this.childView=this.options.childView,this.template=this.options.template,(null==Backbone.pubSub._events||null==Backbone.pubSub._events.childClose)&&Backbone.pubSub.on("childClose",this.onChildClose,this)},render:function(a){var b=(this.$el,this);if(null!=this.options.templateId){var c=_.template($(this.options.templateId).html(),{});this.$el.html(c)}else null!=this.template&&this.$el.html(this.template());return null!=this.childView&&this.childView.render(a),this.$el.find(".close-modal").click(function(a){b.onChildClose({view:b.childView})}),this.$el.show(),this},onChildClose:function(a){null!=this.$el&&this.$el.hide(),Backbone.history.navigate("",!0)}}),PaletteView=SimpleView.extend({template:JST["palette.html"],el:"#palette-container",palette:[{background_color:"#F44336",color:"#fff"},{background_color:"#E91E63",color:"#fff"},{background_color:"#9C27B0",color:"#fff"},{background_color:"#673AB7",color:"#fff"},{background_color:"#3F51B5",color:"#fff"},{background_color:"#2196F3",color:"#fff"},{background_color:"#03A9F4",color:"#000"},{background_color:"#00BCD4",color:"#000"},{background_color:"#009688",color:"#fff"},{background_color:"#4CAF50",color:"#000"},{background_color:"#8BC34A",color:"#000"},{background_color:"#CDDC39",color:"#000"},{background_color:"#FFEB3B",color:"#000"},{background_color:"#FFC107",color:"#000"},{background_color:"#FF9800",color:"#000"},{background_color:"#FF5722",color:"#fff"},{background_color:"#795548",color:"#fff"},{background_color:"#9E9E9E",color:"#fff"},{background_color:"#607D8B",color:"#fff"},{background_color:"#000000",color:"#ffffff"}],initialize:function(a){this.options=a||{}},events:{"click .palette-item":"paletteColorSelected"},render:function(){this.$el.html(this.template({palette:this.palette})),this.$el.fadeIn()},paletteColorSelected:function(a){a.preventDefault();var b=$(a.target),c=b.data("color"),d=b.data("text");$(".palette-editable").css("background-color",c),$(".palette-editable").css("color",d),$(".btn").css("background-color",c),$(".btn").css("color",d),$('.palette-editable[data-opacity="0.7"]').css("background-color",this.opacityColor(c.replace("#","")))},opacityColor:function(a){return"rgba("+parseInt(a.slice(-6,-4),16)+","+parseInt(a.slice(-4,-2),16)+","+parseInt(a.slice(-2),16)+",0.5)"}}),ProfileEditView=SimpleView.extend({template:JST["profile_edit.html"],initialize:function(a){this.options=a||{}},events:{"click .save-profile":"save"},render:function(){this.hidePanels(),this.$el.html(this.template()),this.$name=this.$el.find("#edit-profile-name"),this.$username=this.$el.find("#edit-profile-username"),this.$password=this.$el.find("#edit_profile_password"),this.$password_confirm=this.$el.find("#edit_profile_password_confirm"),this.$email=this.$el.find("#edit-profile-email");var a=this;$.ajax({url:"/api/profile/"+currentUser.id,type:"GET",cache:!1,success:function(b){console.log(b),null!=b.email&&(a.$email.html(b.email),a.$email.parent().addClass("floating-label-form-group-with-value")),null!=b.username&&(a.$username.val(b.username),a.$username.parent().addClass("floating-label-form-group-with-value")),null!=b.name&&(a.$name.val(b.name+" "+b.last_name),a.$name.parent().addClass("floating-label-form-group-with-value"))}})},save:function(){if(validator.validateItems(".valid-before-submit")){null!=this.$password.val()&&this.$password.val()!=this.$password_confirm.val()&&alert_notification([{alertType:"warning",message:"Password and Password confirm don't match!!!"}]);var a={username:this.$username.val()};a.name=this.$name.val().split(" ")[0],a.last_name=this.$name.val().split(" ")[1],null!=this.$password.val()&&""!=this.$password.val()&&(a.password=this.$password.val());$.ajax({url:"/api/profile/"+currentUser.id,type:"POST",data:JSON.stringify(a),cache:!1,success:function(a){Backbone.history.navigate("/search",!0)}})}}}),SentView=Backbone.View.extend({template:JST["invite_sent.html"],initialize:function(a){this.options=a||{}},events:{"click .submit-register":"registerEmail"},render:function(){this.$el.html(this.template({invite_id:this.model})),this.$email=this.$el.find(".register-email")},registerEmail:function(){if(!validator.validateItem(this.$email))return void alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}]);var a=this;$.ajax({url:"/register/email/"+this.$email.val(),type:"POST",cache:!1,success:function(b){alert_notification([{alertType:"success",message:"Account Created Successfully, please check your email"}]),Backbone.pubSub.trigger("childClose",{view:a})},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}),UserRegisterView=SimpleView.extend({template:JST["register.html"],initialize:function(a){this.options=a||{}},events:{"click .submit-register":"registerEmail"},render:function(){this.hidePanels(),this.$el.html(this.template()),this.$email=this.$el.find(".register-email")},registerEmail:function(){if(!validator.validateItem(this.$email))return void alert_notification([{alertType:"warning",message:"You have incorrect or missing fields!"}]);$.ajax({url:"/register/email/"+this.$email.val(),type:"POST",cache:!1,success:function(a){alert_notification([{alertType:"success",message:"Account Created Successfully, please check your email"}]),window.location.href="/"},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}),$(function(){init_app()});