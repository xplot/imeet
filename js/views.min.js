function alert_notification(a){var b=$("#notification-alerts");b.length||(b=$('<div id="notification-alerts" class="jumbotron flyover flyover-bottom"><button class="btn btn-primary alert-close" data-dismiss="alert">X</button></div>'),$("body").append(b)),a.forEach(function(a){b.prepend("            <div class='alert alert-"+a.alertType+"'>"+a.message+"</div>")}),a.length>0&&b.toggleClass("in")}ModalView=Backbone.View.extend({childView:null,template:null,initialize:function(a){this.options=a||{},this.childView=this.options.childView,this.template=this.options.template,(null==Backbone.pubSub._events||null==Backbone.pubSub._events.childClose)&&Backbone.pubSub.on("childClose",this.onChildClose,this)},render:function(a){this.$el;var b=this;if(null!=this.options.templateId){var c=_.template($(this.options.templateId).html(),{});this.$el.html(c)}else null!=this.template&&this.$el.html(this.template());return null!=this.childView&&this.childView.render(a),this.$el.find(".close-modal").click(function(){b.onChildClose({view:b.childView})}),this.$el.modal("show"),this.$el.on("hidden.bs.modal",this.onChildClose),this},onChildClose:function(){null!=this.$el&&this.$el.modal("hide"),Backbone.history.navigate("",!0)}}),SimpleView=Backbone.View.extend({initialize:function(a){this.options=a||{}},render:function(){if($("#body-container").hide(),null!=this.options.templateId){var a=_.template($(this.options.templateId).html(),{});this.$el.html(a),this.$el.show()}}}),IndexView=Backbone.View.extend({initialize:function(a){this.options=a||{}},events:{"click .imeet-btn":"createNew","keypress .invite-title-input":"type_key"},type_key:function(a){return 13==a.keyCode?(this.createNew(),a.preventDefault(),!1):void 0},render:function(){$("#view-container").hide(),this.$el.show(),this.$inviteTitle=this.$el.find(".invite-title-input"),this.$headerImage=this.$el.find(".header-section")},createNew:function(){var a=this.$inviteTitle.val();null!=a&&""!=a?Backbone.history.navigate("/new/"+a,!0):alert("type a title!")}}),InviteView=Backbone.View.extend({template:JST["inviteReport.html"],inviteId:null,initialize:function(a){this.options=a||{},this.inviteId=this.options.id},render:function(a){this.inviteId=a.invite_id,null==this.inviteId&&console.error("Invite Id is null, check routing"),this.$el.html(this.template()),$.ajax({url:"/api/invite/"+this.inviteId,type:"GET",cache:!1,success:function(a){var b=$(".invite-title"),c=$(".invite-date"),d=$(".invite-table");b.html(a.title),c.html(a.when);var e="            <div id='contact{3}' class='row contact-row small-margin' data-contact='{0},{1},{2}' >                     <div class='col-sm-2'> {0} </div>                     <div class='col-sm-2'>  {1} </div>                     <div class='col-sm-2'> {2}</div>                     <div class='col-sm-2'> {3}</div>                     <div class='col-sm-2'> {4}</div>                     <div class='col-sm-2'> {5}</div>             </div> ";a.contacts.forEach(function(a){d.append(e.format(a.name||"N/A",a.phone||"N/A",a.email||"N/A",a.sms_response||'<span class="text-danger">N/A</span>',a.voice_response||'<span class="text-danger">N/A</span>',a.email_response||'<span class="text-danger">N/A</span>'))})}})}}),CreateView=Backbone.View.extend({el:"#header-container",initialize:function(a){this.options=a||{}},events:{"click .new-contact":"newContact","click .remove-contact":"removeContact","click .send":"submitNew"},template:JST["invite.html"],render:function(a){return this.$el.html(this.template()),this.$table=this.$el.find(".contact-table"),this.$btSend=this.$el.find(".send"),this.$contactForm=this.$el.find("#newContactForm"),this.$inviteForm=this.$el.find("#newInviteForm"),this.$new_name=this.$el.find(".new-contact-name"),this.$new_phone=this.$el.find(".new-contact-phone"),this.$new_email=this.$el.find(".new-contact-email"),this.$event_name=this.$el.find(".event-name"),this.$event_date=this.$el.find(".event-date"),this.$btSend=this.$el.find(".send"),this.i=0,null!=a.title&&this.$event_name.val(a.title),this},newContact:function(){if((""!=this.$new_email.val()||""!=this.$new_phone.val())&&(this.$contactForm.validate({rules:{newPhone:{phoneUS:!0}}}),this.$contactForm.valid())){var a="                <div id='contact{3}' class='row contact-row small-margin' data-contact='{0},{1},{2}' >                         <div class='col-sm-3'> {0} </div>                         <div class='col-sm-3'>  {1} </div>                         <div class='col-sm-3'> {2}</div>                         <div class='col-sm-3'>                        <div class='row'>                             <div class='col-sm-4'></div>                            <div class='col-sm-4'>                                <button type='button' class='btn btn-danger form-control remove-contact' data-row='{3}'>-</button>                            </div>                             <div class='col-sm-4'></div>                        </div>                </div> ".format(this.$new_name.val(),this.$new_phone.val(),this.$new_email.val(),this.i);return this.$new_name.val(""),this.$new_email.val(""),this.$new_phone.val(""),this.$table.append(a),this.i++,this.$btSend.removeAttr("disabled"),!1}},removeContact:function(a){var b="#contact"+$(a.currentTarget).data("row");this.$table.find(b).remove();var c=this.$el.find(".contact-row");(null==c||0==c.length)&&this.$btSend.attr("disabled","disabled")},submitNew:function(){var a=this;if(this.$inviteForm.validate({rules:{when:{required:!0,date:!0}}}),this.$inviteForm.valid()){var b=this.$el.find(".contact-row"),c={title:this.$event_name.val(),when:this.$event_date.val(),user_id:null!=currentUser?currentUser.id:null,contacts:[]};b.each(function(){var a=$(this).data("contact"),b=a.split(",");c.contacts.push({name:b[0],email:b[2],phone:b[1]})}),console.log(c),$.ajax({url:"/api/invite",type:"POST",data:JSON.stringify(c),cache:!1,success:function(){a.$el.modal("hide"),Backbone.history.navigate("",!0)}})}}}),SearchView=Backbone.View.extend({template:JST["search.html"],initialize:function(a){this.options=a||{}},events:{"click .search":"search","keypress #searchBox":"type_key"},render:function(){this.$el.html(this.template()),this.$searchForm=this.$el.find("#searchForm"),this.$searchBox=this.$el.find("#searchBox"),this.search()},type_key:function(a){return 13==a.keyCode?(this.search(),a.preventDefault(),!1):void 0},search:function(){this.$searchForm.validate(),this.$searchForm.valid()&&$.ajax({url:"/api/invite/search/"+currentUser.id+"?term="+this.$searchBox.val(),type:"GET",cache:!1,success:function(a){if(null!=a){var b=$(".search-result");b.empty(),a.forEach(function(a){var c="                            <div class='row'>                                <a href='#' class='navigate' data-action='modal' data-where='view/{0}'>{1}</a>                             </div>".format(a.unique_id,a.title);b.append(c)})}}})}}),UserRegisterView=Backbone.View.extend({template:JST["register.html"],initialize:function(a){this.options=a||{}},events:{"click .submit-register":"registerEmail"},render:function(){this.$el.html(this.template()),this.$registerForm=this.$el.find("#registerForm"),this.$email=this.$el.find(".register-email")},registerEmail:function(){if(this.$registerForm.validate(),this.$registerForm.valid()){var a=this;$.ajax({url:"/register/email/"+this.$email.val(),type:"POST",cache:!1,success:function(){Backbone.pubSub.trigger("childClose",{view:a})},error:function(a){alert_notification([{alertType:"danger",message:a.responseText}])}})}}}),UserProfileView=Backbone.View.extend({template:JST["editProfile.html"],initialize:function(a){this.options=a||{}},events:{"click .save-profile":"save"},render:function(){this.$el.html(this.template()),this.$editProfileForm=this.$el.find("#editProfileForm"),this.$name=this.$el.find("#edit-profile-name"),this.$username=this.$el.find("#edit-profile-username"),this.$password=this.$el.find("#edit_profile_password"),this.$email=this.$el.find("#edit-profile-email");var a=this;$.ajax({url:"/api/profile/"+currentUser.id,type:"GET",cache:!1,success:function(b){null!=b.email&&(a.$email.html(b.email),a.$email.parent().addClass("floating-label-form-group-with-value")),null!=b.username&&(a.$username.val(b.username),a.$username.parent().addClass("floating-label-form-group-with-value")),null!=b.name&&(a.$name.val(b.name+" "+b.last_name),a.$name.parent().addClass("floating-label-form-group-with-value"))}})},save:function(){if(this.$editProfileForm.validate({rules:{edit_profile_password:{minlength:5},edit_profile_password_confirm:{minlength:5,equalTo:"#edit_profile_password"}}}),this.$editProfileForm.valid()){var a={username:this.$username.val(),password:this.$password.val()};null!=this.$name.val()&&(a.name=this.$name.val().split(" ")[0],a.last_name=this.$name.val().split(" ")[1]);var b=this;$.ajax({url:"/api/profile/"+currentUser.id,type:"POST",data:JSON.stringify(a),cache:!1,success:function(){Backbone.pubSub.trigger("childClose",{view:b})}})}}});